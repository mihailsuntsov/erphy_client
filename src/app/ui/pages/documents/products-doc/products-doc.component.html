<mat-drawer-container  [ngClass]="{doc_container: mode=='standart',doc_container_select_mode: mode!='standart'}" autosize *transloco="let t">
    <mat-drawer #drawer class="categories-sidenav" mode="side" opened *ngIf="!rightsDefined || (rightsDefined && (( +id>0 && allowToView)||(+id==0 && allowToCreate)))">
        <div class="category-toolbar-search flex">
            <span style="flex-grow: 1;"></span>
                <div>
                    
                </div>
            <span style="flex-grow: 1;"></span>
        </div>
        
        <div class="category-toolbar-icons flex">
            <span style="flex-grow: 1;"></span>
                <div>
                        <button mat-icon-button (click)="expandAllCheckedNodes(); categoriesExpanded=true;"  
                        matTooltip="{{t('docs.tip.p_sh_cat_p')}}" color="primary">
                            <mat-icon>visibility</mat-icon>
                        </button>
                        <button mat-icon-button (click)="collapseAllNodes(); categoriesExpanded=false;" 
                            matTooltip="{{t('docs.tip.collaps_cat')}}" color="primary">
                                <mat-icon>visibility_off</mat-icon>
                        </button>
                        <button mat-icon-button 
                            [disabled]="!(+selectedProductCategory.selectedNodeId>0)"
                            (click)="
                            addCheckbox(selectedProductCategory.selectedNodeId);
                            selectCheckboxesOfAllParents(getNodeById(selectedProductCategory.selectedNodeId)); 
                            categoriesExpanded=false;" 
                            matTooltip="{{t('docs.tip.p_selct_all_c')}}" color="primary">
                                <mat-icon>publish</mat-icon>
                        </button>
                </div>
            <span style="flex-grow: 1;"></span>
        </div>
        <mat-divider></mat-divider>

        <mat-tree [dataSource]="treeDataSource" [treeControl]="treeControl">
            <mat-tree-node *matTreeNodeDef="let node" matTreeNodePadding>
                <button mat-icon-button disabled></button>
                <mat-checkbox style="margin-right:8px;"
                    (click)="$event.stopPropagation()"
                    (change)="$event ? clickTableCheckbox(node.id) : null"
                    [checked]="isSelectedCheckbox(node.id)"
                    >
                </mat-checkbox>
                <span class="node" [ngClass]="{selected_node:node.id==selectedProductCategory.selectedNodeId}" (click)="selectNode(node)">{{node.name}}</span>
            </mat-tree-node>
            <mat-tree-node *matTreeNodeDef="let node;when: hasChild" matTreeNodePadding>
                <button mat-icon-button matTreeNodeToggle
                        [attr.aria-label]="'toggle ' + node.name">
                <mat-icon class="mat-icon-rtl-mirror">
                    {{treeControl.isExpanded(node) ? 'expand_more' : 'chevron_right'}}
                </mat-icon>
                </button>
                <mat-checkbox style="margin-right:8px;"
                    (click)="$event.stopPropagation()"
                    (change)="$event ? clickTableCheckbox(node.id) : null"
                    [checked]="isSelectedCheckbox(node.id)"
                    >
                </mat-checkbox>
                <span class="node" [ngClass]="{selected_node:node.id==selectedProductCategory.selectedNodeId}" (click)="selectNode(node)">{{node.name}}</span>
                
            </mat-tree-node>
        </mat-tree>
        
    </mat-drawer>
    <mat-drawer-content>
        <div class="categories-sidenav-content">
            <mat-card appearance="outlined" class="card for-sticky-header">
                <mat-card-header>
                    <mat-card-title class="top-bar container-fluid"> 
                        <div class="row" id="topBlock">
                            <div id="cardname">
                                <div class="nowrap"><span *ngIf="+id>0">{{formBaseInformation.get('name').value}}</span></div>
                            </div>
                            <div class="separator"></div><!-- !!! -->
                            <button 
                                *ngIf="formBaseInformation.get('storeProductTranslations').value.length>0"
                                (click)="changeTranslationMode()"
                                mat-raised-button 
                                matTooltip="{{'docs.tip.transl_mode' | transloco}}"
                                [color]="storeTranslationModeOn?'accent':'primary'"
                                class="button small-button">
                                <i class="material-icons">translate</i>
                            </button>
                            <button 
                                [matMenuTriggerFor]="addDocMenu"
                                mat-raised-button 
                                matTooltip="{{t('docs.tip.create_docs')}}"
                                *ngIf="+id>0"
                                color="primary"
                                (submit)="false"
                                type="button"
                                class="button small-button">
                                <i class="material-icons">add</i>
                            </button>
                            <mat-menu #addDocMenu="matMenu" yPosition="below" xPosition="before">
                                <button mat-menu-item (click)="goToNewDocument()">
                                    <span>{{t('docs.docs.products')}}</span>
                                </button>
                            </mat-menu>
                            <button 
                                mat-raised-button 
                                [matMenuTriggerFor]="templatesMenu"
                                *ngIf="+id>0"
                                matTooltip="{{t('docs.tip.print')}}"
                                color="primary"                
                                (click)="printDocs()"
                                type="button"
                                (submit)="false"
                                class="button small-button">
                                <i class="material-icons">print</i>
                            </button>
                            <mat-menu #templatesMenu="matMenu" yPosition="below" xPosition="before">
                                <div *ngIf="gettingTemplatesData" style="width:240px; height: 125px;">
                                    <mat-spinner 
                                    strokeWidth="3" 
                                    class="spinner"
                                    style="position: relative;"
                                    [diameter]="50"
                                    *ngIf="gettingTemplatesData"
                                ></mat-spinner>
                                </div>                
                                <button mat-menu-item *ngFor="let template of templatesList">
                                    <div style="width:100%; height: 100%;" (click)="onClickPrintTemplate(template)">
                                        <span>{{template.name}}</span>                    
                                    </div>
                                </button>
                                <mat-divider></mat-divider>
                                <button mat-menu-item (click)="openDialogTemplates()" >
                                    <span>{{t('docs.tip.set_prnt_menu')}}</span>
                                </button>
                                <!-- <mat-divider></mat-divider>  -->
                                <!-- <button mat-menu-item (click)="printLabels(null)" >
                                    <span>{{t('docs.tip.set_prnt_menu')}}</span>
                                </button> -->
                            </mat-menu>
                            <button 
                                mat-raised-button 
                                *ngIf="+id>0 && allowToUpdate"
                                matTooltip="{{t('docs.tip.save')}}"
                                (click)="clickBtnUpdate()"
                                [disabled]="!formBaseInformation.valid || !additionalChecksValid" 
                                color="primary"
                                type="button"
                                class="button small-button">
                                <i class="material-icons">save</i>
                            </button>
                            <button 
                                mat-raised-button 
                                matTooltip="{{t('docs.tip.create')}}"
                                (click)="createNewDocument()" 
                                *ngIf="allowToCreate && +id==0 "
                                [disabled]="!formBaseInformation.valid" 
                                color="primary"
                                type="submit"
                                class="button small-button">
                                <i class="material-icons">done</i>
                            </button>
                            <button  
                                mat-raised-button 
                                matTooltip="{{t('docs.tip.select')}}"
                                [mat-dialog-close]="formBaseInformation.get('product_code_free').value" 
                                *ngIf="(mode=='createFromAnotherDoc') && (+id>0)"
                                color="primary"
                                type="button"
                                class="button small-button">
                                <i class="material-icons">star</i>
                            </button>
                            <a routerLink="../{{+id>0?'../':''}}products">
                                <button 
                                    mat-raised-button 
                                    [matTooltip]="id>0?t('docs.tip.exit'):t('docs.tip.cancel')"
                                    color="accent"
                                    *ngIf="mode=='standart'" 
                                    class="button small-button">
                                    <i class="material-icons">close</i>
                                </button>
                            </a>
                            <button 
                                    matTooltip="{{t('docs.tip.close')}}"
                                    mat-raised-button 
                                    *ngIf="mode!='standart'"
                                    color="accent"
                                    (click)="onNoClick()"
                                    class="button small-button">
                                    <i class="material-icons">close</i>
                            </button>
                        </div>
                    </mat-card-title>
                </mat-card-header>
                <mat-card-content *ngIf="rightsDefined && 
                (
                    (!allowToView && +id>0) ||
                    (!allowToCreate && +id==0)
                )"> 
                    <mat-card appearance="outlined" class="internal-card">
                        <mat-card-content style="font-size: 20px;font-weight: bold;color: red;text-align: center;height: 100px;padding: 38px 0;">
                            {{t('docs.msg.no_perm')}}
                        </mat-card-content>
                    </mat-card>
                </mat-card-content>
                <!-- !!! -->

                <mat-card-content *ngIf="!rightsDefined || (rightsDefined && (( +id>0 && allowToView)||(+id==0 && allowToCreate)))"> 

                    <form  class="form-horizontal" id="formControl" method="post" action="" style="margin-bottom: 0px;">
                            <div class="form-group" style="display: none;">
                                <label class="control-label col-sm-2" for="SortColumn">SelectedNodeId</label>
                                <input [(ngModel)]="selectedProductCategory.selectedNodeId" type="text" class="form-control" id="SelectedNodeId" name="SelectedNodeId" value="">
                            </div>
                            <div class="form-group" style="display: none;">
                                <label class="control-label col-sm-2" for="SortColumn">SelectedNodeName</label>
                                <input [(ngModel)]="selectedProductCategory.selectedNodeName" type="text" class="form-control" id="SelectedNodeName" name="SelectedNodeName" value="">
                            </div>
                    </form>

                    <form [formGroup]="formBaseInformation">
                        <mat-tab-group [selectedIndex]="selectedTab.value" (selectedTabChange)="onSelectTab($event)" *ngIf="!storeTranslationModeOn">

                                <mat-tab label="{{t('docs.tab.info')}}">
                                        <div class="container-fluid">
                                            <div class="row" style="padding: 10px">

                                                <div class="col-lg-4  col-md-12">    
                                                    <!-- {{this.st_prefix_barcode_pieced}}--{{this.st_prefix_barcode_packed}} -->
                                                    <mat-card appearance="outlined" class="card-block">
                                                        <mat-card-header>
                                                            <mat-card-title class="card-title">{{t('docs.card.base_info')}}</mat-card-title>
                                                        </mat-card-header>
                                                        <mat-card-content class="input-form">

                                                            <mat-form-field style="display: none">
                                                                <input  matInput
                                                                        placeholder="id"
                                                                        formControlName="id"/>
                                                            </mat-form-field>
                                                            
                                                            <mat-form-field [ngClass]="{invisible: visAfterCreatingBlocks}" >
                                                                <mat-label>{{t('docs.field.company')}}</mat-label>
                                                                <mat-select  formControlName="company_id" 
                                                                (selectionChange)="onCompanyChange()">                          
                                                                    <mat-option  *ngFor="let rt of receivedCompaniesList" [value]="rt.id">
                                                                            {{rt.abbreviation}}{{rt.name}}
                                                                    </mat-option> 
                                                                </mat-select>
                                                            </mat-form-field>
                                                            <mat-form-field>
                                                                    <mat-label>{{t('docs.field.name')}} <span *ngIf="formBaseInformation.get('name').value==''" class="star">*</span></mat-label>
                                                                <input   matInput 
                                                                        #name
                                                                        maxlength="500"
                                                                        formControlName="name"/>
                                                                <mat-hint  align="start" *ngIf="formBaseInformation.get('name').touched && formBaseInformation.get('name').invalid">
                                                                    <i class="form-invalid">{{t('docs.error.field_miss')}}</i>
                                                                </mat-hint>
                                                                <mat-hint align="end" *ngIf="name.value.length>400">{{name.value.length}} / 500</mat-hint>
                                                            </mat-form-field>

                                                            <div class="flex" *ngIf="formBaseInformation.get('type').value != 'variable'">
                                                                <mat-form-field style="width:65%; margin-right:5px;">
                                                                    <mat-label>{{t('docs.field.p_ppr')}}</mat-label>
                                                                    <mat-select  formControlName="ppr_id" (selectionChange)="onPprChange()">                          
                                                                        <mat-option  *ngFor="let rt of spravSysPPRSet" [value]="rt.id">
                                                                                {{rt.name}}
                                                                        </mat-option> 
                                                                    </mat-select>
                                                                </mat-form-field>
                                                                <mat-form-field style="width:35%;">
                                                                    <mat-label>{{t('docs.field.tax')}}</mat-label>
                                                                    <mat-select  formControlName="nds_id">                          
                                                                        <mat-option  *ngFor="let rt of spravTaxesSet" [value]="rt.id">
                                                                                {{rt.name}}
                                                                        </mat-option> 
                                                                    </mat-select>
                                                                </mat-form-field>
                                                            </div>
                                                            <div class="flex">
                                                                <mat-form-field style="width:50%; margin-right:5px;">
                                                                    <mat-label>{{t('docs.field.p_sku')}}</mat-label>
                                                                    <input   matInput
                                                                            placeholder="{{t('docs.field.p_sku')}}"
                                                                            #article                                                                                
                                                                            (change)="onChangeCrmSKU()"
                                                                            maxlength="100"
                                                                            formControlName="article"/>
                                                                            <mat-hint align="end" *ngIf="article.value.length>80">{{article.value.length}} / 100</mat-hint>
                                                                </mat-form-field>
                                                                <mat-form-field style="width:50%;">
                                                                    <mat-label>{{t('docs.field.p_unit')}} <span *ngIf="+formBaseInformation.get('edizm_id').value==0" class="star">*</span></mat-label>
                                                                    <input matInput
                                                                    type="text"
                                                                    formControlName="edizm_name" 
                                                                    [matAutocomplete]="auto4"
                                                                    (input)="checkEmptyProductEdizmField();"
                                                                    (change)="checkEmptyProductEdizmField();">
                                                                    <mat-icon
                                                                        *ngIf="+formBaseInformation.get('edizm_id').value>0"
                                                                        matTooltip="{{t('docs.tip.clr_srch')}}" 
                                                                        class="add_circle"
                                                                        (click)="formBaseInformation.get('edizm_name').setValue('');checkEmptyProductEdizmField();">
                                                                        close
                                                                    </mat-icon>
                                                                    <mat-autocomplete #auto4="matAutocomplete">
                                                                    <mat-option *ngFor="let option of filteredSpravSysEdizmOfProductAll | async" [value]="option.name">
                                                                        <div (click)="formBaseInformation.get('edizm_id').setValue(option.id)">
                                                                            <span style="margin:10px;">{{option.name}}</span>
                                                                        </div>
                                                                    </mat-option>
                                                                    </mat-autocomplete>
                                                                    <mat-hint  align="start" *ngIf="formBaseInformation.get('edizm_name').touched && formBaseInformation.get('edizm_name').invalid">
                                                                        <i class="form-invalid">{{t('docs.error.field_miss')}}</i>
                                                                    </mat-hint>
                                                                    <mat-hint  align="start" *ngIf="spravSysEdizmOfProductCurrent.length>0 && !goodUnitOfMeasureOfService">
                                                                        <i class="form-invalid">{{t('docs.error.wrong_unit')}}</i>
                                                                    </mat-hint>
                                                                    
                                                                </mat-form-field>
                                                            </div>

                                                            <mat-form-field *ngIf="formBaseInformation.get('type').value != 'variable'">
                                                                <mat-label>{{t('docs.field.lbl_dscrp')}}</mat-label>
                                                                <textarea  matInput
                                                                    maxlength="2000"
                                                                    formControlName="label_description"
                                                                    [rows]="2"
                                                                    #label_description>
                                                                </textarea>
                                                                <mat-hint align="end" *ngIf="label_description.value.length>1800">{{name.value.length}} / 2000</mat-hint>
                                                            </mat-form-field>

                                                            <div class="flex" *ngIf="formBaseInformation.get('type').value != 'variable'">
                                                                <mat-form-field class="slideWidth100" style="width:50%; margin-right:5px;" 
                                                                    >
                                                                    <mat-slide-toggle formControlName="not_sell" (change)="onChangeCrmStockStatus()">{{t('docs.field.p_del_from_sell')}}</mat-slide-toggle>
                                                                    <input matInput hidden/>
                                                                </mat-form-field>
                                                                <mat-form-field style="width:50%" 
                                                                    class="slideWidth100">
                                                                    <mat-slide-toggle formControlName="not_buy">{{t('docs.field.p_not_buying')}}</mat-slide-toggle>
                                                                    <input matInput hidden/>
                                                                </mat-form-field>
                                                                
                                                            </div>
                                                            <div class="flex" *ngIf="formBaseInformation.get('type').value != 'variable'">
                                                                <mat-form-field class="slideWidth100" style="width:50%; margin-right:5px;">
                                                                    <mat-slide-toggle formControlName="indivisible">{{t('docs.field.p_indivisible')}}</mat-slide-toggle>
                                                                    <input matInput hidden/>
                                                                </mat-form-field>
                                                                <mat-form-field style="width:50%" *ngIf="product_code_free_isReadOnly && +formBaseInformation.get('id').value>0 && (+formBaseInformation.get('company_id').value>0)" 
                                                                    class="slideWidth100">
                                                                    <mat-label>{{t('docs.field.code')}}</mat-label>
                                                                    <input  matInput style="height: 24.5px;"
                                                                            (click)="EditProductCodeFree()"
                                                                            placeholder="{{t('docs.field.code')}}"
                                                                            formControlName="product_code_free"
                                                                            [readonly]=true/>
                                                                </mat-form-field>
                                                                <mat-form-field   class="slideWidth100" style="width:50%; margin-right:5px;"
                                                                        *ngIf="!product_code_free_isReadOnly && +formBaseInformation.get('id').value>0 && (+formBaseInformation.get('company_id').value>0)">
                                                                        <mat-label>{{t('docs.field.code')}}</mat-label>
                                                                        <input  matInput
                                                                                #codeFreeValue 
                                                                                maxlength="10"
                                                                                placeholder="{{t('docs.field.code')}}"
                                                                                (keypress)="numberOnly($event)"
                                                                                (change)="checkProductCodeFreeUnical()"
                                                                                formControlName="product_code_free"/>
                                                                        <mat-hint  align="start" *ngIf="formBaseInformation.get('product_code_free').touched && formBaseInformation.get('product_code_free').invalid">
                                                                            <i *ngIf="formBaseInformation.get('product_code_free').errors.pattern" class="form-invalid">{{t('docs.error.num_only')}}</i>
                                                                        </mat-hint>
                                                                        <mat-hint align="end">{{codeFreeValue.value.length}} / 10</mat-hint>
                                                                        <mat-progress-bar *ngIf="isProductCodeFreeUnicalChecking" mode="indeterminate"></mat-progress-bar>
                                                                    </mat-form-field>
                                                            </div>

                                                            <div class="flex" *ngIf="formBaseInformation.get('type').value != 'variable'">
                                                                <mat-form-field 
                                                                    matTooltip="{{t('docs.tip.p_outofst_as')}}"
                                                                    class="slideWidth100">
                                                                    <mat-slide-toggle formControlName="outofstock_aftersale">{{t('docs.field.p_outofst_as')}}</mat-slide-toggle>
                                                                    <input matInput hidden/>
                                                                </mat-form-field>
                                                            </div>

                                                            <div class="flex" *ngIf="formBaseInformation.get('type').value != 'variable' && formBaseInformation.get('ppr_id').value == 4">
                                                                <mat-form-field 
                                                                    class="slideWidth100">                                                                    
                                                                    <mat-slide-toggle 
                                                                        formControlName="is_srvc_by_appointment"
                                                                        (change)="srvc_appoint_toggle($event)"
                                                                        >
                                                                        {{t('docs.field.srvc_appoint')}}
                                                                    </mat-slide-toggle>
                                                                    <input matInput hidden/>
                                                                </mat-form-field>
                                                            </div>

                                                            <div  *ngIf="formBaseInformation.get('type').value != 'variable'"
                                                                 [ngClass]="{invisible: visBeforeCreatingBlocks || (+formBaseInformation.get('ppr_id').value>2)}">
                                                                <div class="flex"  *ngIf="formBaseInformation.get('company_id').value">

                                                                    
                                                                </div>

                                                                <div class="flex" style="display: none;">
                                                                    <mat-form-field 
                                                                    [ngClass]="{slideWidth100: !formBaseInformation.get('by_weight').value,
                                                                                slideWidth50margin8: formBaseInformation.get('by_weight').value}">
                                                                        <mat-slide-toggle formControlName="by_weight">{{t('docs.field.p_weight_prod')}}</mat-slide-toggle>
                                                                        <input matInput hidden/>
                                                                    </mat-form-field>
                                                                    <mat-form-field class="slideWidth100" style="width:50%" 
                                                                    [ngClass]="{invisible: !formBaseInformation.get('by_weight').value}">
                                                                        <input   matInput
                                                                                placeholder="{{t('docs.field.p_w_code')}}"
                                                                                matTooltip="{{t('docs.tip.p_weig_cd_noc')}}"
                                                                                formControlName="product_code" [readonly]=true/>
                                                                        <button 
                                                                        *ngIf="+formBaseInformation.get('product_code').value==0"
                                                                        matSuffix 
                                                                        mat-icon-button 
                                                                        matTooltip="{{t('docs.tip.p_gen_wg_code')}}" color="primary"
                                                                        (click)="generateProductWeightCode()">
                                                                            <mat-icon>offline_bolt</mat-icon>
                                                                            
                                                                        </button>
                                                                    <mat-progress-bar *ngIf="isWeightCodeGenerating" mode="indeterminate"></mat-progress-bar>
                                                                    </mat-form-field>
                                                                </div>

                                                                <mat-form-field  style="display: none;" >
                                                                    <input   matInput
                                                                            placeholder="{{t('docs.field.p_unit')}}"
                                                                            formControlName="edizm_id"/>
                                                                </mat-form-field>
                                                                

                                                                
    
                                                                <div class="flex">
                                                                    <div class="flex" style="width:50%; margin-right:5px;">
                                                                        <mat-form-field style="width:70%;">
                                                                            <input  matInput
                                                                                    placeholder="{{t('docs.field.p_weig')}}"
                                                                                    (keypress)="numberOnlyPlusDotAndComma($event)"
                                                                                    formControlName="weight"/>
                                                                            <mat-hint  align="start" *ngIf="formBaseInformation.get('weight').touched && formBaseInformation.get('weight').invalid">
                                                                                <i *ngIf="formBaseInformation.get('weight').errors.pattern" class="form-invalid">{{t('docs.error.price_format',{int:12,fract:3})}}</i>
                                                                            </mat-hint>
                                                                        </mat-form-field>
                                                                        <mat-form-field style="width:30%;">
                                                                            <mat-label>{{t('docs.field.p_un')}}</mat-label>
                                                                            <mat-select  formControlName="weight_edizm_id">                          
                                                                                <mat-option  *ngFor="let rt of spravSysEdizmOfProductWeight" [value]="rt.id">
                                                                                        {{rt.short_name}}
                                                                                </mat-option> 
                                                                            </mat-select>
                                                                        </mat-form-field>
                                                                    </div>
                                                                    <div class="flex" style="width:50%;">
                                                                        <mat-form-field style="width:70%;">
                                                                            <input  matInput
                                                                                    placeholder="{{t('docs.field.p_vol')}}"
                                                                                    (keypress)="numberOnlyPlusDotAndComma($event)"
                                                                                    formControlName="volume"/>
                                                                            <mat-hint  align="start" *ngIf="formBaseInformation.get('volume').touched && formBaseInformation.get('volume').invalid">
                                                                                <i *ngIf="formBaseInformation.get('volume').errors.pattern" class="form-invalid">{{t('docs.error.price_format',{int:12,fract:3})}}</i>
                                                                            </mat-hint>
                                                                        </mat-form-field>
                                                                        <mat-form-field style="width:30%;">
                                                                            <mat-label>{{t('docs.field.p_un')}}</mat-label>
                                                                            <mat-select  formControlName="volume_edizm_id">                          
                                                                                <mat-option  *ngFor="let rt of spravSysEdizmOfProductVolume" [value]="rt.id">
                                                                                        {{rt.short_name}}
                                                                                </mat-option> 
                                                                            </mat-select>
                                                                        </mat-form-field>
                                                                        
                                                                    </div>
                                                                </div> 
    
                                                                
                                                            </div>    
                                                        </mat-card-content>
                                                    </mat-card>
                                                </div>
                                                <div class="col-lg-4 col-md-12" [ngClass]="{invisible: visBeforeCreatingBlocks}">
                                                    

                                                    <mat-card appearance="outlined" class="card-block" *ngIf="formBaseInformation.get('type').value != 'variable'">
                                                        <mat-card-header>
                                                            <mat-card-title class="card-title">{{t('docs.card.p_prices')}}</mat-card-title>
                                                        </mat-card-header>
                                                        <mat-card-content class="input-form">




                                                            <div class="container-fluid" style="padding-right: 0; padding-left: 0;">
                                                                <div class="row" *ngIf="getControl('productPricesTable').value.length>0" style="margin-right: 0px; margin-left: 0px;">
                                                                    <div class="col-12" style="padding:0px">
                                                                        
                                                                        <table mat-table #_table  [dataSource]="getControl('productPricesTable').value" 
                                                                        [formGroup]="formBaseInformation" 
                                                                        [trackBy]="trackByIndex" 
                                                                        class="mat-elevation-z8">

                                                                            <ng-container matColumnDef="price_type_id" [formArrayName]="'productPricesTable'">
                                                                                <th mat-header-cell *matHeaderCellDef> price_type_id </th>
                                                                                <td mat-cell *matCellDef="let row; let i = index" [formGroupName]="i"> 
                                                                                    <span>{{row.price_type_id}}</span>
                                                                                </td>
                                                                                <td mat-footer-cell *matFooterCellDef></td>
                                                                            </ng-container>
                                                                            <ng-container matColumnDef="price_name" [formArrayName]="'productPricesTable'">
                                                                                <th mat-header-cell *matHeaderCellDef>{{t('docs.field.price_type')}}</th>
                                                                                <td mat-cell *matCellDef="let row; let i = index" [formGroupName]="i"> 
                                                                                    <span>{{row.price_name}}</span>
                                                                                </td>
                                                                                <td mat-footer-cell *matFooterCellDef></td>
                                                                            </ng-container>
                                                                            <ng-container matColumnDef="indx" [formArrayName]="'productPricesTable'">
                                                                                <th mat-header-cell *matHeaderCellDef>indx</th>
                                                                                <td mat-cell *matCellDef="let row; let i = index" [formGroupName]="i"> {{i}} </td>
                                                                                <td mat-footer-cell *matFooterCellDef></td>
                                                                            </ng-container>
                                                                            <ng-container matColumnDef="row_id" [formArrayName]="'productPricesTable'">
                                                                                <th mat-header-cell *matHeaderCellDef> row_id </th>
                                                                                <td mat-cell *matCellDef="let row; let i = index" [formGroupName]="i"> 
                                                                                    <span>{{row.row_id}}</span>
                                                                                </td>
                                                                                <td mat-footer-cell *matFooterCellDef></td>
                                                                            </ng-container>
                                                                            <ng-container matColumnDef="price_value" [formArrayName]="'productPricesTable'">
                                                                                <th mat-header-cell *matHeaderCellDef style="width: 50px;">
                                                                                    <span 
                                                                                        style="cursor: default;"
                                                                                        matTooltip="{{t('docs.tip.p_price_item')}}">
                                                                                        {{t('docs.field.p_price')}}, {{accountingCurrency}}
                                                                                    </span>
                                                                                </th>
                                                                                <td mat-cell *matCellDef="let row; let i = index" [formGroupName]="i" style="min-width: 100px;">
                                                                                    <div style="width:100%;position: relative">
                                                                                        <input  matInput 
                                                                                                style="margin-right: 15px; width: 80px;"
                                                                                                class="table-field-editable"
                                                                                                formControlName="price_value"
                                                                                                placeholder=""
                                                                                                (input)="onChangeCRMPrice(i)"
                                                                                                (keypress)="numberOnlyPlusDot($event)"
                                                                                                />
                                                                                                <button 
                                                                                                        type="button"
                                                                                                        (click)="copyPrice(row.price_value);"
                                                                                                        matTooltip="{{t('docs.tip.p_copy_price')}}"
                                                                                                        matSuffix mat-icon-button 
                                                                                                        *ngIf="getControl('productPricesTable').value.length>1"
                                                                                                        style="padding: 0px;
                                                                                                        min-width: 0px;
                                                                                                        width: 17px;
                                                                                                        height: 17px;
                                                                                                        flex-shrink: 0;
                                                                                                        line-height: 17px;
                                                                                                        border-radius: 50%;
                                                                                                        position: absolute;
                                                                                                        top: -1px;
                                                                                                        right: 12px;
                                                                                                        color: #585858;
                                                                                                        z-index: 1000;">
                                                                                            <mat-icon style="    background-repeat: no-repeat;
                                                                                            display: inline-block;
                                                                                            fill: currentColor;
                                                                                            margin: -3.5px 0px 0-2px;
                                                                                            width: 14px;
                                                                                            font-size: 16px;">content_copy</mat-icon>
                                                                                        </button>
                                                                                        <mat-hint align="start" >
                                                                                            <i *ngIf="getControl('productPricesTable').controls[i].get('price_value').invalid && getControl('productPricesTable').controls[i].get('price_value').errors.pattern" class="table-form-invalid">{{t('docs.error.price_format',{int:7,fract:2})}}</i>
                                                                                        </mat-hint>
                                                                                    </div>
                                                                                </td>
                                                                                <td mat-footer-cell *matFooterCellDef></td>
                                                                            </ng-container>
                                                                            
                                                                            <tr mat-header-row *matHeaderRowDef="pricesDisplayedColumns"></tr>
                                                                            <tr mat-row *matRowDef="let row; columns: pricesDisplayedColumns;"></tr>
                                                                            <!-- <tr mat-footer-row *matFooterRowDef="pricesDisplayedColumns"></tr> -->
                                                                        </table>
                                                                    </div>  
                                                                </div>  
                                                                <div  *ngIf="getControl('productPricesTable').value.length>0" class="col-12 center-align" style="margin-top: 20px;">
                                                                    
                                                                </div>
                                                            </div>





                                                        </mat-card-content>
                                                    </mat-card>





                                                    <mat-card appearance="outlined" class="card-block" id="appointmnt_settngs" *ngIf="formBaseInformation.get('ppr_id').value== 4 && formBaseInformation.get('is_srvc_by_appointment').value"> 
                                                        <mat-card-header>
                                                            <mat-card-title class="card-title">{{t('docs.card.appointmnt_settngs')}}</mat-card-title>
                                                        </mat-card-header>
                                                        <mat-card-content>
                                                            <mat-form-field class="mat-form-field-100">
                                                                <mat-label>{{t('docs.field.dep_parts')}} <span *ngIf="formBaseInformation.get('depparts').value?.length==0" class="star">*</span></mat-label>
                                                                <mat-select
                                                                    panelClass="department-list"
                                                                    formControlName="depparts"
                                                                    #mySelect
                                                                    multiple>
                                                                    <div class="button-row"
                                                                    *ngIf="receivedDepartmentsWithPartsList.length>1">
                                                                        <button
                                                                            mat-icon-button 
                                                                            [disabled]="!editability"
                                                                            matTooltip="{{t('docs.tip.select_all')}}" 
                                                                            class="btn-gray-color"
                                                                            (click)="selectAllCheckList('depparts')"
                                                                        >
                                                                        <mat-icon>fact_check</mat-icon>
                                                                        </button>
                                                                        <button
                                                                            mat-icon-button 
                                                                            [disabled]="!editability"
                                                                            matTooltip="{{t('docs.tip.unselect_all')}}" 
                                                                            class="btn-gray-color"
                                                                            (click)="unselectAllCheckList('depparts')">
                                                                        <mat-icon>ballot</mat-icon>
                                                                        </button>
                                                                    </div>
                                                                    <mat-optgroup 
                                                                        *ngFor="let department of receivedDepartmentsWithPartsList;"
                                                                    >
                                                                        <span class="optgroup-name" 
                                                                        *ngIf="department.parts.length>0">{{department.department_name}}</span>
                                                                        <button 
                                                                            *ngIf="department.parts.length>1"
                                                                            mat-icon-button 
                                                                            [disabled]="!editability"
                                                                            matTooltip="{{t('docs.tip.select_all_onedep')}}" 
                                                                            class="btn-gray-color"
                                                                            (click)="selectAllDepPartsOneDep(department.department_id)"
                                                                        >
                                                                        <mat-icon>fact_check</mat-icon>
                                                                        </button>
                                                                        <button 
                                                                            *ngIf="department.parts.length>1"
                                                                            mat-icon-button 
                                                                            [disabled]="!editability"
                                                                            matTooltip="{{t('docs.tip.unselect_all_onedep')}}" 
                                                                            class="btn-gray-color" 
                                                                            (click)="unselectAllDepPartsOneDep(department.department_id)">
                                                                        <mat-icon>ballot</mat-icon>
                                                                        </button>
                                                                            <mat-option *ngFor= "let part of department.parts;"
                                                                                style="width: 100%;"
                                                                                [value]="part.id"
                                                                                [matTooltip]="part.description"
                                                                                [matTooltipPosition]="'right'"
                                                                            >
                                                                                {{part.name}}
                                                                                <button
                                                                                    mat-icon-button 
                                                                                    [disabled]="!editability"
                                                                                    [matMenuTriggerFor]="deppart_info"
                                                                                    class="btn-gray-color btn-option-info"
                                                                                    (click)="getDeppartServicesNamesList(part.id)"
                                                                                > 
                                                                                <mat-icon
                                                                                    style="border-radius: 50%;
                                                                                    background-image: url(/assets_/images/other/info_icon.png);
                                                                                    background-position: center top;
                                                                                    background-size: 100% auto;"
                                                                                ></mat-icon>
                                                                                </button>
                                                                            </mat-option>
                                                                            
                                                                            
                                                                        <!-- </span> -->
                                                                    </mat-optgroup>
                                                                </mat-select>
                                                                <mat-menu #deppart_info="matMenu" xPosition="after">
                                                                    <div style="width: 300px;">
                                                                        <ul  style="margin: 0px; padding: 12px;">
                                                                            <li *ngFor="let name of servicesList">
                                                                                <span style="position: relative; top: -6px;left: 3px;">{{name}}</span>
                                                                            </li>
                                                                        </ul>
                                                                        <span *ngIf="servicesList.length==0" style="position: relative;top:-8px;left:10px;">{{t('docs.msg.no_srvcs_this_part')}}</span>
                                                                    </div>
                                                                </mat-menu>
                                                                <mat-hint  align="start" *ngIf="formBaseInformation.get('depparts').touched && formBaseInformation.get('is_srvc_by_appointment').value && this.formBaseInformation.get('depparts').value.length==0">
                                                                    <i class="form-invalid">{{t('docs.error.field_miss')}}</i>
                                                                </mat-hint>
                                                            </mat-form-field>
                                                            <mat-form-field 
                                                                class="slideWidth100">                                                                    
                                                                <mat-slide-toggle 
                                                                    (change)="is_employee_required_toggle($event)"
                                                                    formControlName="scdl_is_employee_required">
                                                                    {{t('docs.field.employee_required')}}
                                                                </mat-slide-toggle>
                                                                <input matInput hidden/>
                                                            </mat-form-field>
                                                            <mat-form-field id="employees_list" *ngIf="formBaseInformation.get('scdl_is_employee_required').value" class="mat-form-field-100">
                                                                <mat-label>{{t('docs.field.employees')}} <span *ngIf="formBaseInformation.get('employees').value.length==0" class="star">*</span></mat-label>
                                                                <mat-select
                                                                    panelClass="department-list"
                                                                    formControlName="employees"
                                                                    [disabled]="!editability"
                                                                    #select
                                                                    multiple>
                                                                    <div class="button-row"
                                                                        *ngIf="receivedEmployeesList.length>1">
                                                                        <button 
                                                                            mat-icon-button 
                                                                            matTooltip="{{t('docs.tip.select_all')}}" 
                                                                            class="btn-gray-color"
                                                                            (click)="selectAllCheckList('employees')"
                                                                        >
                                                                            <mat-icon>fact_check</mat-icon>
                                                                        </button>
                                                                        <button 
                                                                            mat-icon-button 
                                                                            matTooltip="{{t('docs.tip.unselect_all')}}" 
                                                                            class="btn-gray-color"
                                                                            (click)="unselectAllCheckList('employees')">
                                                                            <mat-icon>ballot</mat-icon>
                                                                        </button>
                                                                    </div>
                                                                    <ng-container *ngFor= "let jt of receivedEmployeesList;">
                                                                        <mat-option class="employees-list-option"                                                                       
                                                                            [value]="jt.id"
                                                                        >{{jt.name}}                                                                            
                                                                        </mat-option>
                                                                        <span class="jobtitle">{{jt.jobtitle_name}}</span>
                                                                    </ng-container>
                                                                </mat-select>
                                                                <mat-hint  align="start" *ngIf="formBaseInformation.get('employees').touched && formBaseInformation.get('scdl_is_employee_required').value && this.formBaseInformation.get('employees').value.length==0">
                                                                    <i class="form-invalid">{{t('docs.error.field_miss')}}</i>
                                                                </mat-hint>
                                                            </mat-form-field>
                                                            <!-- <mat-form-field 
                                                                style="width:100%; /*margin-right:5px;*/">                                                                    
                                                                <mat-label>{{t('docs.field.max_pers_on_same_time')}} <span *ngIf="formBaseInformation.get('scdl_max_pers_on_same_time').value==''" class="star">*</span></mat-label>
                                                                <input  matInput
                                                                            maxlength="10"                                                                                                                                                   
                                                                            (keypress)="numberOnly($event)"
                                                                            type="number" min="1"
                                                                            #scdl_max_pers_on_same_time
                                                                            formControlName="scdl_max_pers_on_same_time"
                                                                    />
                                                                    <mat-hint  align="start" *ngIf="formBaseInformation.get('scdl_max_pers_on_same_time').touched && formBaseInformation.get('scdl_max_pers_on_same_time').invalid && scdl_max_pers_on_same_time.value!='0'">
                                                                        <i class="form-invalid">{{t('docs.error.field_miss')}}</i>
                                                                    </mat-hint>
                                                                    <mat-hint  align="start" *ngIf="formBaseInformation.get('scdl_max_pers_on_same_time').touched && formBaseInformation.get('scdl_max_pers_on_same_time').invalid && scdl_max_pers_on_same_time.value=='0'">
                                                                        <i class="form-invalid">{{t('modules.error.more_than',{num:0})}}</i>
                                                                    </mat-hint>
                                                            </mat-form-field> -->
                                                            <mat-form-field 
                                                                style="width:65%; margin-right:5px;">                                                                    
                                                                <mat-label>{{t('docs.field.srvc_min_duration')}} <span *ngIf="formBaseInformation.get('scdl_srvc_duration').value==''" class="star">*</span></mat-label>
                                                                    <input  matInput
                                                                            maxlength="10"                                                                            
                                                                            (keypress)="numberOnly($event)"
                                                                            type="number" min="1"
                                                                            #scdl_srvc_duration
                                                                            formControlName="scdl_srvc_duration"
                                                                    />
                                                                    <mat-hint  align="start">
                                                                        <i 
                                                                        class="form-invalid"  
                                                                        *ngIf="formBaseInformation.get('scdl_srvc_duration').touched && formBaseInformation.get('scdl_srvc_duration').invalid && scdl_srvc_duration.value!='0'">
                                                                        {{t('docs.error.field_miss')}}
                                                                    </i>
                                                                        <i 
                                                                        class="form-invalid" 
                                                                        *ngIf="formBaseInformation.get('scdl_srvc_duration').touched && formBaseInformation.get('scdl_srvc_duration').invalid && scdl_srvc_duration.value=='0'">
                                                                        {{t('modules.error.more_than',{num:0})}}
                                                                    </i>
                                                                    </mat-hint>
                                                            </mat-form-field>

                                                            <mat-form-field style="width: calc(35% - 6px);">
                                                                <mat-label>&nbsp; <span *ngIf="formBaseInformation.get('scdl_srvc_duration_unit_id').value==null" class="star">*</span></mat-label>
                                                                <mat-select  formControlName="scdl_srvc_duration_unit_id">                          
                                                                    <mat-option *ngFor="let rt of spravSysEdizmOfProductTime" [value]="rt.id">
                                                                            {{rt.short_name}}
                                                                    </mat-option> 
                                                                </mat-select>
                                                                <mat-hint  align="start" *ngIf="formBaseInformation.get('scdl_srvc_duration_unit_id').touched && formBaseInformation.get('edizm_name').invalid">
                                                                    <i class="form-invalid">{{t('docs.error.field_miss')}}</i>
                                                                </mat-hint>
                                                            </mat-form-field>

                                                            <!-- <mat-form-field 
                                                                style="width:65%; margin-right:5px;">                                                                    
                                                                <mat-label>{{t('docs.field.scedule_appntmnt_before')}} <span *ngIf="formBaseInformation.get('scdl_appointment_atleast_before_time').value==null" class="star">*</span></mat-label>
                                                                    <input  matInput
                                                                            maxlength="10"                                                                            
                                                                            (keypress)="numberOnly($event)"
                                                                            type="number" min="0"
                                                                            #scdl_appointment_atleast_before_time
                                                                            formControlName="scdl_appointment_atleast_before_time"
                                                                    />
                                                                    <mat-hint  align="start" *ngIf="formBaseInformation.get('scdl_appointment_atleast_before_time').touched && formBaseInformation.get('scdl_appointment_atleast_before_time').invalid && scdl_appointment_atleast_before_time.value!='0'">
                                                                        <i class="form-invalid">{{t('docs.error.field_miss')}}</i>
                                                                    </mat-hint>
                                                            </mat-form-field> -->

                                                            <!-- <mat-form-field style="width: calc(35% - 6px);">
                                                                <mat-label>&nbsp;</mat-label>
                                                                <mat-select  formControlName="scdl_appointment_atleast_before_unit_id">                          
                                                                    <mat-option *ngFor="let rt of spravSysEdizmOfProductTime" [value]="rt.id">
                                                                            {{rt.short_name}}
                                                                    </mat-option> 
                                                                </mat-select>
                                                            </mat-form-field> -->

                                                            <!-- <mat-form-field class="slideWidth100">
                                                                <mat-label>{{t('docs.field.customer_reminders')}}</mat-label>
                                                                <mat-select formControlName="scdl_customer_reminders" multiple>
                                                                    <mat-option *ngFor="let rt of remindersList" [value]="rt.id">
                                                                        {{rt.type}} {{rt.value_text}}
                                                                    </mat-option> 
                                                                </mat-select>
                                                            </mat-form-field> -->

                                                            <!-- <mat-form-field class="slideWidth100">
                                                                <mat-label>{{t('docs.field.employee_reminders')}}</mat-label>
                                                                <mat-select formControlName="scdl_employee_reminders" multiple>
                                                                    <mat-option *ngFor="let rt of remindersList" [value]="rt.id">
                                                                        {{rt.type}} {{rt.value_text}}
                                                                    </mat-option> 
                                                                </mat-select>
                                                            </mat-form-field> -->

                                                            <!-- <mat-form-field class="slideWidth100">
                                                                <mat-label>{{t('docs.field.assignments_ways')}}</mat-label>
                                                                <mat-select formControlName="scdl_assignments" multiple>
                                                                    <mat-option *ngFor="let rt of assignmentsList" [value]="rt.id">
                                                                        {{rt.name}}
                                                                    </mat-option> 
                                                                </mat-select>
                                                            </mat-form-field> -->

                                                        </mat-card-content>
                                                    </mat-card>
                                             
                                                    
                                                                                                        
                                                    <mat-card appearance="outlined" class="card-block" *ngIf="formBaseInformation.get('ppr_id').value== 4 && formBaseInformation.get('is_srvc_by_appointment').value">
                                                        <mat-card-header>                          
                                                            <mat-card-title class="card-title">
                                                                <div class="flex card">
                                                                        {{t('docs.card.resources')}}
                                                                    <div style="position: absolute; right: 20px;">
                                                                        <button matTooltip="{{t('docs.tip.p_edit')}}" 
                                                                                    mat-mini-fab 
                                                                                    color="primary" 
                                                                                    *ngIf="!showSearchFormFields && editability"
                                                                                    (click)="
                                                                                    showSearchFormFields=!showSearchFormFields;
                                                                                    refreshRresourceTableColumns();">
                                                                                <mat-icon>edit</mat-icon>
                                                                        </button>
                                                                    </div>
                                                                </div>
                                                            </mat-card-title>
                                                        </mat-card-header>
                                                        <mat-card-content class="input-form">

                                                            <form #form="ngForm" [formGroup]="formResourceSearch" *ngIf="showSearchFormFields">

                                                                <div class="row">

                                                                

                                                                    <div class="col-xl-6 col-lg-6 col-md-12">
                                                                        <mat-form-field  class="mat-form-field-100">
                                                                            <mat-label>
                                                                                {{t('docs.field.resource')}}
                                                                            </mat-label>
                                                                            <mat-select
                                                                            panelClass="department-list"
                                                                            formControlName="resource_id">
                                                                                <mat-option value="0">---</mat-option>
                                                                                <mat-option *ngFor="let resource of resourcesList;"
                                                                                            [value]="resource.resource_id"
                                                                                            (click)="
                                                                                            formResourceSearch.get('name').setValue(resource.name);
                                                                                            formResourceSearch.get('resource_id').setValue(resource.resource_id);"

                                                                                            [matTooltip]="resource.description"
                                                                                            [matTooltipPosition]="'right'"
                                                                                >
                                                                                    {{resource.name}}
                                                                                </mat-option>
                                                                            </mat-select>
                                                                        </mat-form-field>

                                                                    </div>
                                                                    <div class="col-xl-3 col-lg-2 col-md-12">

                                                                        <mat-form-field  class="mat-form-field-100">
                                                                            <mat-label>{{t('modules.field.count')}}</mat-label>

                                                                            <input matInput 
                                                                                [readonly]="!editability"
                                                                                placeholder=""
                                                                                type="number" min="0"
                                                                                formControlName="resource_qtt"
                                                                            />
                                                                            
                                                                            <mat-hint align="start" >
                                                                                <i *ngIf="  formResourceSearch.get('resource_qtt').value !='' && 
                                                                                            !isInteger(parseFloat(formResourceSearch.get('resource_qtt').value))"  class="table-form-invalid">
                                                                                            {{t('modules.error.mst_be_integr')}}
                                                                                </i>
                                                                                <i *ngIf="formResourceSearch.get('resource_qtt').invalid && formResourceSearch.get('resource_qtt').errors.pattern" class="table-form-invalid">{{t('modules.error.price_format',{int:5,fract:0})}}</i>
                                                                                <control-messages  class="table-form-invalid" [control]="formResourceSearch.get('resource_qtt')"></control-messages>
                                                                            </mat-hint>
                                                                            
                                                                        </mat-form-field>                                                    
                                                                    </div>
                                                                    <div class="col-xl-2 col-lg-3 col-md-12" [style.display]="((allowToCreate && +id==0)||(allowToUpdate && id>0)) ?'block':'none'">
                                                                        <div class="center hand" style="width:100%; height: 38px; text-align: right;">
                                                                            <button matTooltip="{{t('docs.tip.add_row')}}" 
                                                                                    mat-mini-fab color="primary" 
                                                                                    [disabled]="+formResourceSearch.get('resource_id').value == 0" 
                                                                                    (click)="addResourceRow()">
                                                                                <mat-icon>add</mat-icon>
                                                                            </button>
                                                                        </div>
                                                                    </div>

                                                                </div>

                                                            </form>


                                                            <div class="row" *ngIf="getControl('productResourcesTable').value.length>0 || gettingTableData" style="margin-right:0;margin-left:0;">
                                                                <mat-spinner 
                                                                strokeWidth="3" 
                                                                class="spinner"
                                                                [diameter]="44"
                                                                *ngIf="gettingTableData"
                                                                ></mat-spinner>
                                                                <table mat-table #resources_table
                                                                [dataSource]="getControl('productResourcesTable').value" 
                                                                [formGroup]="formBaseInformation" 
                                                                [trackBy]="trackByIndex" 
                                                                style="margin-top: 20px;" 
                                                                class="mat-elevation-z8 resources-table">
                                                                    <!-- Name of resource Column -->
                                                                    <ng-container matColumnDef="name" [formArrayName]="'productResourcesTable'">
                                                                        <th mat-header-cell *matHeaderCellDef>{{t('modules.col.name')}}</th>
                                                                        <td mat-cell *matCellDef="let row; let i = index" [formGroupName]="i"> 
                                                                            <span>{{row.name}}</span>
                                                                        </td>
                                                                    </ng-container>
                                                                    <!-- Quantity Column -->
                                                                    <ng-container matColumnDef="resource_qtt" [formArrayName]="'productResourcesTable'">
                                                                        <th mat-header-cell *matHeaderCellDef style="width: 60px;">
                                                                            <span 
                                                                                style="cursor: default;"
                                                                                matTooltip="{{t('modules.tip.cnt_to_order')}}">
                                                                                {{t('modules.col.qnt')}}
                                                                            </span>
                                                                        </th>
                                                                        <td mat-cell *matCellDef="let row; let i = index" 
                                                                        style="width: 80px;"
                                                                        [formGroupName]="i">
                                                                            <input matInput 
                                                                                class="quantity-field"
                                                                                [ngClass]="{'table-field-editable':editability&&showSearchFormFields}"
                                                                                [readonly]="!showSearchFormFields || !editability"
                                                                                style="width: 50px !important;"
                                                                                type="number" min="0"
                                                                                placeholder=""
                                                                                formControlName="resource_qtt"
                                                                            />
                                                                            <!-- <mat-hint align="start" >*{{i}}*{{getControl('productResourcesTable').controls[i].get('resource_qtt').value}}*</mat-hint> -->
                                                                            <control-messages  class="table-form-invalid" [control]="getControl('productResourcesTable').controls[i].get('resource_qtt')"></control-messages>
                                                                            <mat-hint align="start" >
                                                                                <i *ngIf="  getControl('productResourcesTable').controls[i].get('resource_qtt').value !='' && 
                                                                                            !isInteger(parseFloat(getControl('productResourcesTable').controls[i].get('resource_qtt').value))"  class="table-form-invalid">
                                                                                            {{t('modules.error.mst_be_integr')}}
                                                                                </i>
                                                                                <i *ngIf="getControl('productResourcesTable').controls[i].get('resource_qtt').invalid && getControl('productResourcesTable').controls[i].get('resource_qtt').errors.pattern" class="table-form-invalid">{{t('modules.error.price_format',{int:5,fract:0})}}</i>
                                                                            </mat-hint>
                                                                    </ng-container>
                    
                                                                    <!-- Delete Column -->
                                                                    <ng-container matColumnDef="delete" [formArrayName]="'productResourcesTable'">
                                                                        <th mat-header-cell *matHeaderCellDef style="width: 30px;"><mat-icon style="cursor: default" (click)="clearResourcesTable()" matTooltip="{{t('modules.tip.del_frm_tabl_')}}">close</mat-icon></th>
                                                                        <td mat-cell *matCellDef="let row; let i = index" [formGroupName]="i">
                                                                            <mat-icon style="cursor: default" (click)="deleteResourceRow(row,i)">delete_forever</mat-icon>
                                                                        </td>
                                                                    </ng-container>
                    
                                                                    <tr mat-header-row *matHeaderRowDef="displayedResourcesColumns"></tr>
                                                                    <tr mat-row *matRowDef="let row; columns: displayedResourcesColumns;"></tr>
                                                                    
                    
                                                                </table> 
                                                            </div>


                                                        </mat-card-content>
                                                    </mat-card>




                                                    <mat-card appearance="outlined" class="card-block" *ngIf="!formBaseInformation.get('is_srvc_by_appointment').value"> 
                                                        <mat-card-header>
                                                            <mat-card-title class="card-title">{{t('docs.card.p_suppliers')}}</mat-card-title>
                                                        </mat-card-header>
                                                        <mat-card-content>
                                                            <div class="box-list" cdkDropList (cdkDropListDropped)="dropCagent($event)">
                                                                <ng-container *ngFor="let cagent of cagentsInfo">
                                                                    <div class="field-box-drag" cdkDrag style="cursor:move;">
                                                                        <div style="display: table; width: 100%">
                                                                            <div class="img-wrapper" style="cursor:move; ">
                                                                                <div class="vertical-center">{{cagent.name}}</div><p *cdkDragPreview></p>
                                                                            </div>
                                                                        </div>
                                                                        <div style="width:110px; min-width:110px;">
                                                                            <!-- <a class="inactive" [routerLink]="['../cagentsdoc', cagent.cagent_id ]">
                                                                                <mat-icon matTooltip="Открыть карточку поставщика">launch</mat-icon>
                                                                            </a> -->
                                                                            <a target="_blank" href="ui/cagentsdoc/{{cagent.cagent_id}}">
                                                                            <mat-icon matTooltip="{{t('docs.tip.p_opn_prod_ca')}}" class="icon">launch</mat-icon></a>
                                                                            <mat-icon matTooltip="{{t('docs.tip.p_soppl_propr')}}" class="icon" (click)="clickBtnEditCagentProperties(cagent.cagent_id, cagent.cagent_article, cagent.additional)">edit</mat-icon>
                                                                            <mat-icon matTooltip="{{t('docs.tip.p_dep_supplir')}}" class="icon" (click)="clickBtnDeleteCagent(cagent.cagent_id)">delete_forever</mat-icon>
                                                                        </div>
                                                                    </div>
                                                                </ng-container>
                                                            </div>
                                                            <div class="div-100" [style.display]="visBtnUpdate==true?'block':'none'"> 
                                                                <div class="center" style="width:100%; height: 38px;">
                                                                    <button matTooltip="{{t('docs.tip.p_add_supplrs')}}" [ngClass]="{invisible: visBeforeCreatingBlocks}" mat-mini-fab color="primary" (click)="openDialogAddCagents()">
                                                                        <mat-icon>add</mat-icon>
                                                                    </button>
                                                                </div>
                                                            </div> 
                                                        </mat-card-content>
                                                    </mat-card>
                                                    <mat-card appearance="outlined" class="card-block" *ngIf="formBaseInformation.get('type').value != 'variable'"> 
                                                        <mat-card-header>
                                                            <mat-card-title class="card-title">{{t('docs.card.p_barcodes')}}</mat-card-title>
                                                        </mat-card-header>                                                        
                                                        <mat-card-content>
                                                            <div>
                                                                <ng-container *ngFor="let barcode of barcodesInfo">
                                                                    <div class="field-box-drag">
                                                                        <div style="display: table; width: 100%; cursor:default">
                                                                            <div class="img-wrapper">
                                                                                <div class="vertical-center"  matTooltip="{{barcode.value}}">
                                                                                    <span>{{barcode.name}}</span>
                                                                                    <span *ngIf="barcode.description!=''">&nbsp;({{barcode.description}})</span>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                        <!-- barcode.id - это primary key таблицы product_barcodes -->
                                                                        <div style="width:75px; min-width:75px;">
                                                                            <mat-icon matTooltip="{{t('docs.tip.p_edit')}}" class="icon" 
                                                                            (click)="clickBtnEditBarcodeProperties(
                                                                                barcode.id,
                                                                                barcode.barcode_id,
                                                                                barcode.value, 
                                                                                barcode.description,
                                                                                barcode.name)">edit</mat-icon>
                                                                            <mat-icon matTooltip="{{t('docs.tip.p_del_barcode')}}" class="icon" (click)="clickBtnDeleteBarcode(barcode.id)">delete_forever</mat-icon>
                                                                        </div>
                                                                    </div>
                                                                </ng-container>
                                                            </div>
                                                            <div class="div-100" [style.display]="visBtnUpdate==true?'block':'none'"> 
                                                                <div class="center" style="width:100%; height: 38px;">
                                                                    <button matTooltip="{{t('docs.tip.p_add_barcode')}}" [ngClass]="{invisible: visBeforeCreatingBlocks}" mat-mini-fab color="primary" (click)="openDialogAddBarcodes()">
                                                                        <mat-icon>add</mat-icon>
                                                                    </button>
                                                                </div>
                                                            </div>                                                             
                                                        </mat-card-content>
                                                    </mat-card>
                                                </div>

                                                

                                                <div class="col-lg-4 col-md-12"  [ngClass]="{invisible: visBeforeCreatingBlocks}">
                                                    <mat-card appearance="outlined" class="card-block">
                                                        <mat-card-header>
                                                            <mat-card-title class="card-title">{{t('docs.card.p_pics')}}</mat-card-title>
                                                        </mat-card-header>
                                                        <mat-card-content>
                                                            <div class="div-foto hand"> 
                                                                <img *ngIf="imagesInfo && imagesInfo.length==0" matTooltip="{{t('docs.tip.p_ni_pics_prd')}}" class="img" src="{{noImageAddress}}" width=100%>
                                                                <img *ngIf="imagesInfo && imagesInfo.length>0" matTooltip="{{t('docs.tip.p_open_pictur')}}" class="img" (click)="showMainImage()" [src]="imageToShow" width=100%>
                                                            </div> 
                                                            <div class="box-list" cdkDropList (cdkDropListDropped)="dropImage($event)">
                                                                <ng-container *ngFor="let i of imagesInfo">
                                                                    <div class="field-box-drag" cdkDrag style="cursor:move;">
                                                                        <div matTooltip="{{t('docs.tip.p_open_pictur')}}" class="img-wrapper" style="cursor:move; ">
                                                                            <img (click)="showImage(i.name)" [src]="i.image" class="thumb_image hand"><p *cdkDragPreview></p>
                                                                        </div>
                                                                        <div style="width:50px; min-width:70px;">
                                                                            <mat-icon  matTooltip="{{t('docs.tip.open_file')}}" (click)="openFileCard(i.id)" class="icon" >launch</mat-icon>
                                                                            <mat-icon matTooltip="{{t('docs.tip.p_delete_pict')}}" class="icon" (click)="clickBtnDeleteImage(i.id)">delete_forever</mat-icon>
                                                                        </div>
                                                                    </div>
                                                                </ng-container>
                                                            </div>
                                                            <div class="div-100" [style.display]="visBtnUpdate==true?'block':'none'"> 
                                                                <div class="center" style="width:100%; height: 38px;">
                                                                    <button matTooltip="{{t('docs.tip.p_add_picture')}}" [ngClass]="{invisible: visBeforeCreatingBlocks}" mat-mini-fab color="primary" (click)="openDialogAddFiles('image')" matTooltip="{{t('docs.tip.p_upload_pict')}}">
                                                                        <mat-icon>add</mat-icon>
                                                                    </button>
                                                                </div>
                                                            </div> 
                                                        </mat-card-content>
                                                    </mat-card>
                                                </div> 
                                            </div>
                                        </div>   
                                </mat-tab>

                                <mat-tab  *ngIf="visAfterCreatingBlocks && formBaseInformation.get('type').value != 'variable' && +formBaseInformation.get('company_id').value>0"  label="{{t('docs.tab.operations')}}">
                                    <mat-spinner 
                                        strokeWidth="3" 
                                        class="spinner"
                                        [diameter]="50"
                                        *ngIf="gettingTableData"
                                    ></mat-spinner>
                                    <mat-card appearance="outlined" class="card">
                                        <mat-card-content>
                                            <div class="card  w-100">
                                                <div class="card-body">
                                                        <div class="flex" style="display:none">
                                                            <div class="form-group">
                                                                <label class="control-label col-sm-2" for="offset">offset</label>
                                                                <input [(ngModel)]="formProductHistory.offset" 
                                                                value="" 
                                                                type="text" 
                                                                class="form-control" 
                                                                id="offset" 
                                                                name="offSet"
                                                                [ngModelOptions]="{standalone: true}">
                                                            </div>
                                    
                                                            <div class="form-group">
                                                                <label class="control-label col-sm-2" for="SortColumn">SortColumn</label>
                                                                <input [(ngModel)]="formProductHistory.sortColumn" 
                                                                type="text" 
                                                                class="form-control" 
                                                                id="SortColumn" 
                                                                name="SortColumn" 
                                                                value=""
                                                                [ngModelOptions]="{standalone: true}">
                                                            </div>
                                                            <div class="form-group">
                                                                <label class="control-label col-sm-2" for="SortAsc">SortAsc</label>
                                                                <input [(ngModel)]="formProductHistory.sortAsc" 
                                                                type="text" 
                                                                class="form-control" 
                                                                id="SortAsc" 
                                                                name="SortAsc" 
                                                                value=""
                                                                [ngModelOptions]="{standalone: true}">
                                                            </div>
                                                        </div> 
                                                        <div class="flex" >
                                                            <mat-form-field style="width:50px;" class="num-of-rows">
                                                                <mat-label>{{t('docs.field.p_rows')}}</mat-label>
                                                                <mat-select [(value)]="formProductHistory.result" (selectionChange)="setNumOfPages()" class="form-control" id="selectRowsPerPage" name="result">                           
                                                                    <mat-option  *ngFor="let num of numRows" [value]="num.value">
                                                                            {{num.viewValue}}
                                                                    </mat-option>
                                                                </mat-select>
                                                            </mat-form-field>

                                                            <mat-form-field style=" min-width: 100px;
                                                                                    margin-left: 20px;
                                                                                    width: 300px;">
                                                                <mat-label>{{t('docs.field.department')}}</mat-label>
                                                                <mat-select  [(value)]="formProductHistory.departmentId" (selectionChange)="getTable()">
                                                                    <mat-option *ngIf="receivedDepartmentsList && receivedDepartmentsList.length>1" value="0" selected>Все доступные отделения</mat-option>                          
                                                                    <mat-option  *ngFor="let rdl of receivedDepartmentsList" [value]="rdl.id">
                                                                            {{rdl.name}}
                                                                    </mat-option>
                                                                </mat-select>
                                                            </mat-form-field>
                                                            
                                                            <mat-form-field class="date-range" style="margin-left:20px;">
                                                                <mat-label>{{t('docs.field.date_range')}}</mat-label>
                                                                <mat-date-range-input [rangePicker]="picker">
                                                                <input matStartDate (dateChange)="getData()" [(ngModel)]="formProductHistory.dateFrom" [ngModelOptions]="{standalone: true}" placeholder="{{t('menu.top.date_from')}}">
                                                                <input matEndDate (dateChange)="getData()" [(ngModel)]="formProductHistory.dateTo" [ngModelOptions]="{standalone: true}" placeholder="{{t('menu.top.date_to')}}">
                                                                </mat-date-range-input>
                                                                <mat-datepicker-toggle matIconSuffix [for]="picker"></mat-datepicker-toggle>
                                                                <mat-date-range-picker #picker></mat-date-range-picker>
                                                                <mat-error *ngIf="!getMoment(formProductHistory.dateFrom).isValid()"><i>{{t('menu.top.start_date')}}</i></mat-error>
                                                                <mat-error *ngIf="!getMoment(formProductHistory.dateTo).isValid()"><i>{{t('docs.error.end_date')}}</i></mat-error>
                                                            </mat-form-field>

                                                            <span  class="emptyspace"></span>
                                                            <button
                                                                    style="margin: 10px" 
                                                                    [matMenuTriggerFor]="oper"
                                                                    type="button"
                                                                    matTooltip="{{t('docs.tip.p_select_oper')}}"
                                                                    matSuffix mat-icon-button>
                                                                    <mat-icon>list_alt</mat-icon>
                                                                    </button>
                                                                    <mat-menu #oper="matMenu" xPosition="before">
                                                                        <div style="width: 250px;">
                                                                            <ul>
                                                                                <li *ngFor="let row of documentsIds">
                                                                                        <mat-checkbox
                                                                                        (click)="$event.stopPropagation()"
                                                                                        (change)="$event ? clickDocumentCheckbox(row) : null"
                                                                                        [checked]="selection.isSelected(row)"
                                                                                        >{{t(row.name)}}</mat-checkbox>
                                                                                </li>
                                                                            </ul>
                                                                        </div>
                                                                    </mat-menu>
                                                            <button 
                                                                matTooltip="{{t('docs.tip.p_show_his_op')}}"
                                                                style="margin: 10px 10px 10px 0;"
                                                                (click)="getTable()"  
                                                                type="submit"
                                                                [disabled]="!datesExistAndValid"
                                                                matSuffix mat-icon-button>
                                                                <mat-icon>search</mat-icon>
                                                            </button>
                                                        </div>
                                                        <div id="result_form">
                                                            <table mat-table [dataSource]="dataSource" class="mat-elevation-z8">
                                                                <ng-container matColumnDef="department">
                                                                    <th mat-header-cell *matHeaderCellDef matTooltip="{{t('docs.tip.p_name_depart')}}">
                                                                    <span class="sortheader"> {{t('docs.field.department')}}  
                                                                    </span>
                                                                    <td mat-cell *matCellDef="let row"> {{row.department}} </td>
                                                                </ng-container>
                                                                <ng-container matColumnDef="docName">
                                                                    <th mat-header-cell *matHeaderCellDef matTooltip="{{t('docs.tip.p_name_operat')}}">
                                                                    <span class="sortheader"> {{t('docs.field.p_operation')}} 
                                                                    </span>
                                                                    <td mat-cell *matCellDef="let row">
                                                                        <a class="inactive" target="_blank" href="ui/{{row.page_name}}doc/{{row.docId}}">
                                                                            {{row.docName}}
                                                                        </a>
                                                                    </td>
                                                                </ng-container>
                                                                <ng-container matColumnDef="before">
                                                                    <th mat-header-cell *matHeaderCellDef matTooltip="{{t('docs.tip.p_count_produ')}}">
                                                                    <span class="sortheader"> {{t('docs.field.p_cnt_bf')}} 
                                                                    </span>
                                                                    <td mat-cell *matCellDef="let row"> {{formBaseInformation.get('ppr_id').value==1?round(row.quantity-row.change):round(0)}} </td>
                                                                </ng-container>
                                                                <ng-container matColumnDef="change">
                                                                    <th mat-header-cell *matHeaderCellDef matTooltip="{{t('docs.tip.p_ch_products')}}">
                                                                    <span class="sortheader"> {{t('docs.field.p_change')}} 
                                                                    </span>
                                                                    <td mat-cell *matCellDef="let row"> {{(row.change>0?'+':'')}}{{row.change}} </td>
                                                                </ng-container>
                                                                <ng-container matColumnDef="quantity">
                                                                    <th mat-header-cell *matHeaderCellDef matTooltip="{{t('docs.tip.p_cnt_prod_op')}}">
                                                                    <span class="sortheader"> {{t('docs.field.p_cnt_af')}}
                                                                    </span>
                                                                    <td mat-cell *matCellDef="let row"> {{formBaseInformation.get('ppr_id').value==1?row.quantity:round(0)}} </td>
                                                                </ng-container>
                                                                <ng-container matColumnDef="date_time_created">
                                                                    <th mat-header-cell *matHeaderCellDef matTooltip="{{t('docs.tip.p_operat_date')}}">
                                                                    <span (click)="setSort('date_time_created_sort')" class="sortheader"> {{t('docs.field.p_oper_date')}} 
                                                                        <i *ngIf="this.formProductHistory.sortAsc=='asc' && this.formProductHistory.sortColumn=='date_time_created_sort'" class="material-icons sortarrow">arrow_upward</i>
                                                                        <i *ngIf="this.formProductHistory.sortAsc=='desc' && this.formProductHistory.sortColumn=='date_time_created_sort'" class="material-icons sortarrow">arrow_downward</i>
                                                                    </span>
                                                                    <td mat-cell *matCellDef="let row"> {{row.date_time_created}} </td>
                                                                </ng-container>
                                                                <ng-container matColumnDef="price">
                                                                    <th mat-header-cell *matHeaderCellDef matTooltip="{{t('docs.tip.p_operat_pric')}}">
                                                                    <span class="sortheader"> {{t('docs.field.p_oper_price')}} 
                                                                    </span>
                                                                    <td mat-cell *matCellDef="let row"> {{row.price}} </td>
                                                                </ng-container>
                                                                <!-- <ng-container matColumnDef="last_purchase_price">
                                                                    <th mat-header-cell *matHeaderCellDef matTooltip="Цена, по которой товар поступил на склад в последней операции приёмки или оприходования">
                                                                    <span (click)="setSort('last_purchase_price')" class="sortheader"> Последняя цена<br>получения 
                                                                    </span>
                                                                    <td mat-cell *matCellDef="let row"> {{row.last_purchase_price}} </td>
                                                                </ng-container> -->
                                                                <!-- <ng-container matColumnDef="avg_purchase_price">
                                                                    <th mat-header-cell *matHeaderCellDef matTooltip="Средняя цена, по которой товар поступал на склад. Рассчитывается исходя из цен поступления товара и остатков от предыдущих поступлений.">
                                                                    <span (click)="setSort('avg_purchase_price')" class="sortheader"> Средняя цена<br>получения
                                                                    </span>
                                                                    <td mat-cell *matCellDef="let row"> {{row.avg_purchase_price}} </td>
                                                                </ng-container> -->
                                                                <ng-container matColumnDef="netcost">
                                                                    <th mat-header-cell *matHeaderCellDef matTooltip="{{t('docs.tip.p_net_cost_op')}}">
                                                                    <span class="sortheader"> {{t('docs.field.p_op_netcost')}} 
                                                                    </span>
                                                                    <td mat-cell *matCellDef="let row"> {{row.netcost}} </td>
                                                                </ng-container>
                                                                <ng-container matColumnDef="avg_netcost_price">
                                                                    <th mat-header-cell *matHeaderCellDef matTooltip="{{t('docs.tip.p_av_net_cost')}}">
                                                                    <span class="sortheader"> {{t('docs.field.p_av_netcost')}} 
                                                                    </span>
                                                                    <td mat-cell *matCellDef="let row"> {{row.avg_netcost_price}} </td>
                                                                </ng-container>
                                                                
                                                                <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                                                                <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
                                                                
                                                                <!-- Part "Data not founded" --> 
                                                                <ng-container matColumnDef="data_not_found">
                                                                    <td mat-footer-cell *matFooterCellDef colspan="13" class="text-center">
                                                                        {{t('menu.msg.dt_not_fnd')}}
                                                                    </td>
                                                                </ng-container>
                                                                <ng-container matColumnDef="nocolumn">
                                                                    <td mat-footer-cell *matFooterCellDef colspan="13" style="display: none;"></td>
                                                                </ng-container>
                                                                <tr mat-footer-row 
                                                                *matFooterRowDef="[(dataSource.data&&dataSource.data.length==0)?'data_not_found':'nocolumn']" 
                                                                [ngStyle]="(dataSource.data && dataSource.data.length==0 && !gettingTableData)?{}:{'display': 'none'}"></tr>
                                                                <!-- End of Part "Data not founded" -->

                                                            </table>
                                                            <div class="flex">
                                                                <div class="col-sm">
                                                                    <p> </p>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    <!-- </form> -->
                                                </div> 
                                            </div>  
                                        </mat-card-content>
                                    </mat-card>
                                </mat-tab>
                                
                                <!-- Booking -->
                                <!--mat-tab  *ngIf="is_store"  label="{{t('docs.tab.booking')}}">
                                    <mat-card style="margin:10px;" id="product_properties">
                                        <mat-card-header>
                                            <mat-card-title class="card-title">{{t('docs.card.prod_prprts')}}</mat-card-title>
                                        </mat-card-header>
                                        <mat-card-content class="input-form">

                                            <div class="row" style="padding: 10px">



                                            </div>

                                        </mat-card-content>
                                    </mat-card>
                                </mat-tab-->


                                <mat-tab  *ngIf="is_store"  label="{{t('docs.tab.store')}}">
                                    <mat-card appearance="outlined" style="margin:10px;" id="product_properties">
                                        <mat-card-header>
                                            <mat-card-title class="card-title">{{t('docs.card.prod_prprts')}}</mat-card-title>
                                        </mat-card-header>
                                        <mat-card-content class="input-form">

                                            <div class="row" style="padding: 10px">
                                                <div class="col-lg-4  col-md-12" >

                                                    <mat-form-field  class="mat-form-field-100">
                                                        <mat-label>{{t('docs.field.product_type')}}</mat-label>
                                                        <input  *ngIf="isVariation" matInput disabled  
                                                            value="{{t('docs.list.variation')}}"
                                                            />
                                                        <mat-select *ngIf="!isVariation" formControlName="type" #type>
                                                            <mat-option value="simple">
                                                                {{t('docs.list.simple')}}
                                                            </mat-option>
                                                            <!-- <mat-option value="grouped">
                                                                {{t('docs.list.grouped')}}
                                                            </mat-option>
                                                            <mat-option value="external">
                                                                {{t('docs.list.external')}}
                                                            </mat-option>-->
                                                            <mat-option value="variable">
                                                                {{t('docs.list.variable')}}
                                                            </mat-option>
                                                            <!-- <mat-option value="variation">
                                                                {{t('docs.list.variation')}}
                                                            </mat-option>   -->
                                                        </mat-select>
                                                    </mat-form-field>

                                                </div>
                                                <!-- <div class="col-lg-4  col-md-12"  *ngIf="formBaseInformation.get('type').value=='simple'">
                                                    <div class="flex">
                                                        <mat-form-field 
                                                            class="slideWidth100">
                                                            <mat-slide-toggle formControlName="virtual" matTooltip="{{t('docs.tip.virtual')}}">{{t('docs.field.virtual')}}</mat-slide-toggle>
                                                            <input matInput hidden/>
                                                        </mat-form-field>
                                                    </div>
                                                </div>
                                                <div class="col-lg-4  col-md-12"  *ngIf="formBaseInformation.get('type').value=='simple'">
                                                    <div class="flex">
                                                        <mat-form-field 
                                                            class="slideWidth100">
                                                            <mat-slide-toggle formControlName="downloadable" matTooltip="{{t('docs.tip.downloadable')}}">{{t('docs.field.downloadable')}}</mat-slide-toggle>
                                                            <input matInput hidden/>
                                                        </mat-form-field>
                                                    </div>
                                                </div> -->
                                            </div>


                                            <div class="row" style="padding: 10px">
                                                <div class="col-12" >
                                                    <mat-drawer-container class="drawer-container">
                                                        <mat-drawer class="mat-drawer" #drawer2 mode="side" opened style="width:145px;">
                                                            <div class="row mat-drawer-row"  *ngIf="formBaseInformation.get('type').value!='grouped' && formBaseInformation.get('type').value!='variable'">
                                                                <div class="col-12" (click)="propertiesMenuClick('general')" class="drawer-menu" [ngClass]="{'drawer-menu-selected':prop_menu=='general'}">
                                                                    <span> {{t('docs.tab.general')}} </span>
                                                                </div>
                                                            </div>
                                                            <div class="row mat-drawer-row">
                                                                <div class="col-12" (click)="propertiesMenuClick('inventory')" class="drawer-menu" [ngClass]="{'drawer-menu-selected':prop_menu=='inventory'}">
                                                                    <span> {{t('docs.tab.inventory')}} </span>
                                                                </div>
                                                            </div>
                                                            <div class="row mat-drawer-row" *ngIf="!formBaseInformation.get('virtual').value && (formBaseInformation.get('type').value=='variable' || formBaseInformation.get('type').value=='simple')">
                                                                <div class="col-12" (click)="propertiesMenuClick('shipping')" class="drawer-menu" [ngClass]="{'drawer-menu-selected':prop_menu=='shipping'}">
                                                                    <span> {{t('docs.tab.shipping')}} </span>
                                                                </div>
                                                            </div>
                                                            <div class="row mat-drawer-row" *ngIf="!isVariation">
                                                                <div class="col-12" (click)="propertiesMenuClick('linked')" class="drawer-menu" [ngClass]="{'drawer-menu-selected':prop_menu=='linked'}">
                                                                    <span> {{t('docs.tab.lnkd_prdcts')}} </span>
                                                                </div>
                                                            </div>
                                                            <div class="row mat-drawer-row" *ngIf="!isVariation">
                                                                <div class="col-12" (click)="propertiesMenuClick('attributes')" class="drawer-menu" [ngClass]="{'drawer-menu-selected':prop_menu=='attributes'}">
                                                                    <span> {{t('docs.tab.attributes')}} </span>
                                                                </div>
                                                            </div>
                                                            <div class="row mat-drawer-row"  *ngIf="formBaseInformation.get('type').value=='variable'">
                                                                <div class="col-12" (click)="propertiesMenuClick('variations')" class="drawer-menu" [ngClass]="{'drawer-menu-selected':prop_menu=='variations'}">
                                                                    <span> {{t('docs.tab.variations')}} </span>
                                                                </div>
                                                            </div>
                                                            <div class="row mat-drawer-row" *ngIf="!isVariation">
                                                                <div class="col-12" (click)="propertiesMenuClick('advanced')" class="drawer-menu" [ngClass]="{'drawer-menu-selected':prop_menu=='advanced'}">
                                                                    <span> {{t('docs.tab.advanced')}} </span>
                                                                </div>
                                                            </div>
                                                        </mat-drawer>  
                                                        <mat-drawer-content style="margin-left: 150px;">
                                                            <div class="container-fluid">
                                                                <div class="row">
                                                                    <div class="col-12" *ngIf="prop_menu=='general'" class="drawer-settings">
                                                                        
                                                                        <mat-form-field  class="mat-form-field-100" *ngIf="formBaseInformation.get('type').value=='external' && formBaseInformation.get('type').value!='variable'">
                                                                            <mat-label>{{t('docs.field.p_ext_url')}}</mat-label>
                                                                            <input  matInput 
                                                                            formControlName="external_url"
                                                                            placeholder="https://"
                                                                            maxlength="250"/>
                                                                            <mat-hint align="end" *ngIf="formBaseInformation.get('external_url').value.length>200">{{formBaseInformation.get('external_url').value.length}} / 250</mat-hint>
                                                                        </mat-form-field>
                                                                        
                                                                        <mat-form-field  class="mat-form-field-100" *ngIf="formBaseInformation.get('type').value=='external' && formBaseInformation.get('type').value!='variable'">
                                                                            <mat-label>{{t('docs.field.p_bttn_txt')}}</mat-label>
                                                                            <input  matInput 
                                                                            formControlName="button_text"
                                                                            placeholder="{{t('docs.field.p_buy_prod')}}"
                                                                            maxlength="60"/>
                                                                            <mat-hint align="end" *ngIf="formBaseInformation.get('button_text').value.length.length>50">{{formBaseInformation.get('button_text').value.length}} / 60</mat-hint>
                                                                        </mat-form-field>
                                                                        
                                                                        <!--mat-form-field class="mat-form-field-100" *ngIf="formBaseInformation.get('type').value!='variable'">
                                                                            <mat-label>{{t('docs.field.reg_price')}}</mat-label>
                                                                            <input  matInput
                                                                                    formControlName="reg_price"
                                                                                    [readonly]="!reg_price_selected"
                                                                                    (input)="onChangeStorePrice('reg_price')"                                                                    
                                                                                    (keypress)="numberOnlyPlusDotAndComma($event);"
                                                                                    />
                                                                                <mat-hint  align="start" *ngIf="formBaseInformation.get('reg_price').touched && formBaseInformation.get('reg_price').invalid">
                                                                                    <i *ngIf="formBaseInformation.get('reg_price').errors.pattern" class="form-invalid">{{t('docs.error.price_format',{int:7,fract:2})}}</i>
                                                                                </mat-hint>
                                                                                <div *ngIf="!reg_price_selected" style="position: absolute;top: 0px;right: -3px;color:orange">
                                                                                    <mat-icon
                                                                                        class="hand"
                                                                                        style="font-size: 20px;"
                                                                                        matTooltip="{{'docs.tip.no_reg_price_sel' | transloco}}">
                                                                                        warning
                                                                                    </mat-icon> 
                                                                                </div>
                                                                        </mat-form-field>
                                                                        <mat-form-field class="mat-form-field-100" *ngIf="formBaseInformation.get('type').value!='variable'">
                                                                            <mat-label>{{t('docs.field.sale_price')}}</mat-label>
                                                                            <input  matInput
                                                                                    formControlName="sale_price"           
                                                                                    [readonly]="!sales_price_selected"
                                                                                    (input)="onChangeStorePrice('sale_price');"                                                        
                                                                                    (keypress)="numberOnlyPlusDotAndComma($event);"
                                                                                    />
                                                                                <mat-hint  align="start" *ngIf="formBaseInformation.get('sale_price').touched && formBaseInformation.get('sale_price').invalid">
                                                                                    <i *ngIf="formBaseInformation.get('sale_price').errors.pattern" class="form-invalid">{{t('docs.error.price_format',{int:7,fract:2})}}</i>
                                                                                </mat-hint>
                                                                                <div *ngIf="!sales_price_selected" style="position: absolute;top: 0px;right: -3px;color:orange">
                                                                                    <mat-icon
                                                                                        class="hand"
                                                                                        style="font-size: 20px;"
                                                                                        matTooltip="{{'docs.tip.no_sale_price_sel' | transloco}}">
                                                                                        warning
                                                                                    </mat-icon> 
                                                                                </div>
                                                                        </mat-form-field-->
                                                                        
                                                                        <mat-form-field  class="mat-form-field-100" *ngIf="formBaseInformation.get('type').value!='variable'">
                                                                            <mat-label>{{t('docs.field.sale_from')}}</mat-label>
                                                                            <input  matInput 
                                                                                    placeholder="{{t('docs.field.sale_from')}}"
                                                                                    formControlName="date_on_sale_from_gmt"
                                                                                    [ngClass]="{'is-invalid':formBaseInformation.get('date_on_sale_from_gmt').touched && formBaseInformation.get('date_on_sale_from_gmt').invalid}"
                                                                                    [matDatepicker]="dp"/>
                                                                                    <mat-datepicker-toggle matSuffix [for]="dp"></mat-datepicker-toggle>
                                                                            <mat-datepicker #dp></mat-datepicker>
                                                                            <mat-hint *ngIf="formBaseInformation.get('date_on_sale_from_gmt').touched && formBaseInformation.get('date_on_sale_from_gmt').invalid" class="invalid-feedback">
                                                                                <i class="form-invalid">{{t('docs.error.date_format')}}</i>
                                                                            </mat-hint>
                                                                        </mat-form-field>
                                                                        <mat-form-field  class="mat-form-field-100" *ngIf="formBaseInformation.get('type').value!='variable'">
                                                                            <mat-label>{{t('docs.field.sale_to')}}</mat-label>
                                                                            <input  matInput 
                                                                                    placeholder="{{t('docs.field.sale_to')}}"
                                                                                    formControlName="date_on_sale_to_gmt"
                                                                                    [ngClass]="{'is-invalid':formBaseInformation.get('date_on_sale_to_gmt').touched && formBaseInformation.get('date_on_sale_to_gmt').invalid}"
                                                                                    [matDatepicker]="dp2"/>
                                                                                    <mat-datepicker-toggle matSuffix [for]="dp2"></mat-datepicker-toggle>
                                                                            <mat-datepicker #dp2></mat-datepicker>
                                                                            <mat-hint *ngIf="formBaseInformation.get('date_on_sale_to_gmt').touched && formBaseInformation.get('date_on_sale_to_gmt').invalid" class="invalid-feedback">
                                                                                <i class="form-invalid">{{t('docs.error.date_format')}}</i>
                                                                            </mat-hint>
                                                                        </mat-form-field>
                                                                        <div *ngIf="formBaseInformation.get('downloadable').value">
                                                                            <mat-divider></mat-divider>
                                                                            <div style="text-align: center;"><h3>Downloadable files</h3></div>
                                                                            <div class="box-list" cdkDropList (cdkDropListDropped)="dropDfile($event)">
                                                                                <ng-container *ngFor="let i of downloadableFilesInfo">
                                                                                    <div class="field-box-drag" cdkDrag style="cursor:move;">
                                                                                        <div matTooltip="{{t('docs.tip.p_open_pictur')}}" class="img-wrapper" style="cursor:move; ">
                                                                                            <span style="line-height: 3.5em;">{{i.original_name}}</span><p *cdkDragPreview></p>
                                                                                        </div>
                                                                                        <div style="width:50px; min-width:70px;">
                                                                                            <mat-icon  matTooltip="{{t('docs.tip.open_file')}}" (click)="openFileCard(i.id)" class="icon" >launch</mat-icon>
                                                                                            <mat-icon matTooltip="{{t('docs.tip.p_delete_file')}}" class="icon" (click)="clickBtnDeleteDownloadableFile(i.id)">delete_forever</mat-icon>
                                                                                        </div>
                                                                                    </div>
                                                                                </ng-container>
                                                                            </div>
                                                                            <div class="div-100" [style.display]="visBtnUpdate==true?'block':'none'"> 
                                                                                <div class="center" style="width:100%; height: 38px;">
                                                                                    <button matTooltip="{{t('docs.tip.p_add_dfiles')}}" [ngClass]="{invisible: visBeforeCreatingBlocks}" mat-mini-fab color="primary" (click)="openDialogAddFiles('dfile')" matTooltip="{{t('docs.tip.p_upload_pict')}}">
                                                                                        <mat-icon>add</mat-icon>
                                                                                    </button>
                                                                                </div>
                                                                            </div>

                                                                            
                                                                            <mat-form-field class="slideWidth100">
                                                                                <mat-label>{{t('docs.field.download_limit')}}</mat-label>
                                                                                <input  matInput
                                                                                        placeholder="{{t('docs.field.unlim')}}"
                                                                                        maxlength="8"
                                                                                        matTooltip="{{t('docs.tip.download_limit')}}"
                                                                                        (keypress)="numberOnly($event)"
                                                                                        formControlName="download_limit"/>
                                                                                <mat-hint  align="start" *ngIf="formBaseInformation.get('download_limit').touched && formBaseInformation.get('download_limit').invalid">
                                                                                    <i *ngIf="formBaseInformation.get('download_limit').errors.pattern" class="form-invalid">{{t('docs.error.price_format',{int:8,fract:0})}}</i>
                                                                                </mat-hint>
                                                                            </mat-form-field>
                                                                            <mat-form-field class="slideWidth100">
                                                                                <mat-label>{{t('docs.field.download_expiry')}}</mat-label>
                                                                                <input  matInput
                                                                                        placeholder="{{t('docs.field.never')}}"
                                                                                        matTooltip="{{t('docs.tip.download_expiry')}}"
                                                                                        maxlength="8"
                                                                                        (keypress)="numberOnly($event)"
                                                                                        formControlName="download_expiry"/>
                                                                                <mat-hint  align="start" *ngIf="formBaseInformation.get('download_expiry').touched && formBaseInformation.get('download_expiry').invalid">
                                                                                    <i *ngIf="formBaseInformation.get('download_expiry').errors.pattern" class="form-invalid">{{t('docs.error.price_format',{int:8,fract:0})}}</i>
                                                                                </mat-hint>
                                                                            </mat-form-field>

                                                                        </div>
                                                                        <mat-divider style="margin:10px 0"></mat-divider>

                                                                        
                                                                        <mat-form-field *ngIf="is_vat" class="mat-form-field-100" style="width:360px">
                                                                            <mat-label>{{t('docs.field.tax_status')}}</mat-label>
                                                                            <mat-select formControlName="tax_status">
                                                                                <option value="" selected></option>
                                                                                <mat-option value="taxable">{{t('docs.list.ts_taxable')}}</mat-option>
                                                                                <mat-option value="shippng">{{t('docs.list.ts_shippng')}}</mat-option>
                                                                                <mat-option value="none">{{t('docs.list.ts_none')}}</mat-option>    
                                                                            </mat-select>                                              
                                                                        </mat-form-field>
                                                                    </div>
                                                                    <div class="col-12" *ngIf="prop_menu=='inventory'" class="drawer-settings">
                                                                        <mat-form-field  class="mat-form-field-100">
                                                                            <mat-label>{{t('docs.field.p_sku')}}</mat-label>
                                                                            <input  matInput 
                                                                            [(ngModel)]="store_sku"
                                                                            placeholder="{{t('docs.field.p_sku')}}"
                                                                            (change)="onChangeStoreSKU()"
                                                                            maxlength="128"
                                                                            [ngModelOptions]="{standalone: true}"/>
                                                                            <mat-hint align="end" *ngIf="store_sku.length>100">{{store_sku.length}} / 120</mat-hint>
                                                                        </mat-form-field>
                                                                        <mat-form-field 
                                                                            *ngIf="formBaseInformation.get('type').value=='variable' || formBaseInformation.get('type').value=='simple'"
                                                                            class="slideWidth100">
                                                                            <mat-slide-toggle formControlName="manage_stock"
                                                                            matTooltip="{{t('docs.tip.manage_stock')}}">{{t('docs.field.manage_stock')}}</mat-slide-toggle>
                                                                            <input matInput hidden/>
                                                                        </mat-form-field>
                                                                        <mat-form-field  class="mat-form-field-100"
                                                                            *ngIf="!formBaseInformation.get('manage_stock').value && formBaseInformation.get('type').value=='simple'">
                                                                            <mat-label>{{t('docs.field.stock_status')}}</mat-label>
                                                                            <mat-select formControlName="stock_status" 
                                                                            (selectionChange)="onChangeStoreStockStatus()"
                                                                            matTooltip="{{t('docs.tip.stock_status')}}">
                                                                                <option value="" selected></option>
                                                                                <mat-option value="instock">{{t('docs.list.p_ss_instck')}}</mat-option>
                                                                                <mat-option value="outofstock">{{t('docs.list.p_ss_outfstck')}}</mat-option>
                                                                                <mat-option value="onbackorder">{{t('docs.list.p_ss_onbckrdr')}}</mat-option>    
                                                                            </mat-select>                                              
                                                                        </mat-form-field>
                                                                        <mat-form-field  class="mat-form-field-100">
                                                                            <mat-label>{{t('docs.field.alw_backrdr')}}</mat-label>
                                                                            <mat-select formControlName="backorders" 
                                                                            matTooltip="{{t('docs.tip.alw_backrdr')}}">
                                                                                <option value="" selected></option>
                                                                                <mat-option value="no">{{t('docs.list.alw_bo_n')}}</mat-option>
                                                                                <mat-option value="notify">{{t('docs.list.alw_bo_nt')}}</mat-option>
                                                                                <mat-option value="yes">{{t('docs.list.alw_bo_y')}}</mat-option>    
                                                                            </mat-select>                                              
                                                                        </mat-form-field>
                                                                        <mat-form-field style="width:100%;" *ngIf="formBaseInformation.get('manage_stock').value">
                                                                            <input  matInput
                                                                                    placeholder="{{t('docs.field.p_l_s_thres')}}"
                                                                                    (keypress)="numberOnlyPlusDotAndComma($event)"
                                                                                    formControlName="low_stock_threshold"/>
                                                                            <mat-hint  align="start" *ngIf="formBaseInformation.get('low_stock_threshold').touched && formBaseInformation.get('low_stock_threshold').invalid">
                                                                                <i *ngIf="formBaseInformation.get('low_stock_threshold').errors.pattern" class="form-invalid">{{t('docs.error.price_format',{int:9,fract:3})}}</i>
                                                                            </mat-hint>
                                                                        </mat-form-field>
                                                                        <mat-form-field 
                                                                            class="slideWidth100" *ngIf="formBaseInformation.get('type').value=='variable' || formBaseInformation.get('type').value=='simple'">
                                                                            <mat-slide-toggle 
                                                                            formControlName="sold_individually"
                                                                            matTooltip="{{t('docs.tip.sold_indiv')}}"
                                                                            >{{t('docs.field.sold_indiv')}}</mat-slide-toggle>
                                                                            <input matInput hidden/>
                                                                        </mat-form-field>
                                                                    </div>
                                                                    <div class="col-12" *ngIf="prop_menu=='shipping' && !formBaseInformation.get('virtual').value && (formBaseInformation.get('type').value=='variable' || formBaseInformation.get('type').value=='simple')" class="drawer-settings">
                                                                        <mat-form-field style="width:100%;">
                                                                            <mat-label>{{t('docs.field.p_weig')}}</mat-label>
                                                                            <input  matInput
                                                                                    placeholder="{{t('docs.field.p_weig')}}"
                                                                                    (keypress)="numberOnlyPlusDotAndComma($event)"
                                                                                    formControlName="weight"/>
                                                                            <mat-hint  align="start" *ngIf="formBaseInformation.get('weight').touched && formBaseInformation.get('weight').invalid">
                                                                                <i *ngIf="formBaseInformation.get('weight').errors.pattern" class="form-invalid">{{t('docs.error.price_format',{int:12,fract:3})}}</i>
                                                                            </mat-hint>
                                                                        </mat-form-field>
                                                                        <mat-form-field style="width:100%;">
                                                                            <mat-label>{{t('docs.field.p_length')}}</mat-label>
                                                                            <input  matInput
                                                                                    placeholder="{{t('docs.field.p_length')}}"
                                                                                    (keypress)="numberOnlyPlusDotAndComma($event)"
                                                                                    formControlName="length"/>
                                                                            <mat-hint  align="start" *ngIf="formBaseInformation.get('length').touched && formBaseInformation.get('length').invalid">
                                                                                <i *ngIf="formBaseInformation.get('length').errors.pattern" class="form-invalid">{{t('docs.error.price_format',{int:7,fract:3})}}</i>
                                                                            </mat-hint>
                                                                        </mat-form-field>
                                                                        <mat-form-field style="width:100%;">
                                                                            <mat-label>{{t('docs.field.p_width')}}</mat-label>
                                                                            <input  matInput
                                                                                    placeholder="{{t('docs.field.p_width')}}"
                                                                                    (keypress)="numberOnlyPlusDotAndComma($event)"
                                                                                    formControlName="width"/>
                                                                            <mat-hint  align="start" *ngIf="formBaseInformation.get('width').touched && formBaseInformation.get('width').invalid">
                                                                                <i *ngIf="formBaseInformation.get('width').errors.pattern" class="form-invalid">{{t('docs.error.price_format',{int:7,fract:3})}}</i>
                                                                            </mat-hint>
                                                                        </mat-form-field>
                                                                        <mat-form-field style="width:100%;">
                                                                            <mat-label>{{t('docs.field.p_height')}}</mat-label>
                                                                            <input  matInput
                                                                                    placeholder="{{t('docs.field.p_height')}}"
                                                                                    (keypress)="numberOnlyPlusDotAndComma($event)"
                                                                                    formControlName="height"/>
                                                                            <mat-hint  align="start" *ngIf="formBaseInformation.get('height').touched && formBaseInformation.get('height').invalid">
                                                                                <i *ngIf="formBaseInformation.get('height').errors.pattern" class="form-invalid">{{t('docs.error.price_format',{int:7,fract:3})}}</i>
                                                                            </mat-hint>
                                                                        </mat-form-field>
                                                                    </div>
                                                                    <div class="col-12" *ngIf="prop_menu=='linked'" style="width: 100% ;padding: 20px;">
                                                                        <div class="row">
                                                                            <div class="col-12">
                                                                                <div class="chip-list" appearance="fill"  *ngIf="formBaseInformation.get('type').value=='grouped'">
                                                                                    <mat-label *ngIf="selectedGroupedProducts && selectedGroupedProducts.length>0">{{'docs.field.grouped' | transloco}}</mat-label>
                                                                                    <span class="chip-name" *ngIf="selectedGroupedProducts && selectedGroupedProducts.length==0">{{'docs.field.grouped' | transloco}}</span>
                                                                                    <mat-chip-listbox #chipList aria-label="Selected objects">
                                                                                        <mat-chip-option
                                                                                            *ngFor="let object of selectedGroupedProducts"
                                                                                            [selectable]="true"
                                                                                            [removable]="true"
                                                                                            (removed)="remove(object, 'grouped')">
                                                                                            {{object.name}}
                                                                                            <mat-icon matChipRemove *ngIf="true">cancel</mat-icon>
                                                                                        </mat-chip-option>
                                                                                        <button matTooltip="{{t('docs.tip.select')}}" mat-mini-fab color="primary" style="width: 30px; height: 30px; margin:5px;" (click)="openDialogProductCategoriesSelect('grouped')">
                                                                                            <mat-icon style="font-size: 18px; line-height: 1;height: 20px;width: 20px;">add</mat-icon>
                                                                                        </button>
                                                                                    </mat-chip-listbox>
                                                                                </div>
                                                                                <div class="chip-list" appearance="fill">
                                                                                    <mat-label *ngIf="selectedUpsellProducts && selectedUpsellProducts.length>0">{{'docs.field.upsells' | transloco}}</mat-label>
                                                                                    <span class="chip-name" *ngIf="selectedUpsellProducts && selectedUpsellProducts.length==0">{{'docs.field.upsells' | transloco}}</span>
                                                                                    <mat-chip-listbox #chipList aria-label="Selected objects">
                                                                                        <mat-chip-option
                                                                                            *ngFor="let object of selectedUpsellProducts"
                                                                                            [selectable]="true"
                                                                                            [removable]="true"
                                                                                            (removed)="remove(object, 'up')">
                                                                                            {{object.name}}
                                                                                            <mat-icon matChipRemove *ngIf="true">cancel</mat-icon>
                                                                                        </mat-chip-option>
                                                                                        <button matTooltip="{{t('docs.tip.select')}}" mat-mini-fab color="primary" style="position: absolute; right: 15px; width: 30px; height: 30px; margin:5px;" (click)="openDialogProductCategoriesSelect('up')">
                                                                                            <mat-icon style="font-size: 18px; line-height: 1;height: 20px;width: 20px;">add</mat-icon>
                                                                                        </button>
                                                                                    </mat-chip-listbox>
                                                                                </div>
                                                                                <div class="chip-list" appearance="fill"  *ngIf="formBaseInformation.get('type').value=='variable' || formBaseInformation.get('type').value=='simple'">
                                                                                    <mat-label *ngIf="selectedCrosssellProducts && selectedCrosssellProducts.length>0">{{'docs.field.crosssells' | transloco}}</mat-label>
                                                                                    <span class="chip-name" *ngIf="selectedCrosssellProducts && selectedCrosssellProducts.length==0">{{'docs.field.crosssells' | transloco}}</span>
                                                                                    <mat-chip-listbox #chipList aria-label="Selected objects">
                                                                                        <mat-chip-option
                                                                                            *ngFor="let object of selectedCrosssellProducts"
                                                                                            [selectable]="true"
                                                                                            [removable]="true"
                                                                                            (removed)="remove(object, 'cross')">
                                                                                            {{object.name}}
                                                                                            <mat-icon matChipRemove *ngIf="true">cancel</mat-icon>
                                                                                        </mat-chip-option>
                                                                                        <button matTooltip="{{t('docs.tip.select')}}" mat-mini-fab color="primary" style="position: absolute; right: 15px; width: 30px; height: 30px; margin:5px;" (click)="openDialogProductCategoriesSelect('cross')">
                                                                                            <mat-icon style="font-size: 18px; line-height: 1;height: 20px;width: 20px;">add</mat-icon>
                                                                                        </button>
                                                                                    </mat-chip-listbox>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    <div class="col-12" *ngIf="prop_menu=='attributes'"  style="width: 100% ;padding: 20px;">
                                                                        <div style="width:100%; padding:10px; text-align: left;">
                                                                            <mat-form-field style="width:35%; min-width:100px; margin-right: 10px;">
                                                                                <mat-label>{{t('docs.field.add_attr')}}</mat-label>
                                                                                <mat-select  
                                                                                        [(ngModel)]="selectedAttribute"
                                                                                        [ngModelOptions]="{standalone: true}">                          
                                                                                    <mat-option  
                                                                                    *ngFor="let rt of productAttributesList" 
                                                                                    (click)="addNewProductAttribute()"
                                                                                    [value]="rt">
                                                                                            {{rt.name}}
                                                                                    </mat-option> 
                                                                                </mat-select>
                                                                            </mat-form-field>
                                                                        </div>
                                                                        <div style="width:100%; padding:10px; text-align: left;">
                                                                            <div cdkDropList (cdkDropListDropped)="dropProductAttribute($event)">
                                                                                <mat-card   appearance="outlined"   *ngFor="let attribute of formBaseInformation.get('productAttributes').controls;let i = index" 
                                                                                            [formGroup]="attribute"
                                                                                            cdkDrag
                                                                                            style="background-color: #f7f7f7; width: 100%">
                                                                                        <div style = "width:100%">
                                                                                            <div style="position:relative; top:5px; left:5px; font-size: 20px; font-weight: 600;">
                                                                                                {{getAttributeFieldValue(i, 'name')}}
                                                                                            </div>
                                                                                            <div cdkDragHandle class="handler"  [style.display]="allowToUpdate?'block':'none'" style="position:absolute; top:10px; right: 35px">
                                                                                                <mat-icon   matTooltip="{{t('docs.tip.move')}}" 
                                                                                                            class="nav-icon"
                                                                                                            *ngIf="formBaseInformation.get('productAttributes').controls.length>1">
                                                                                                            swap_vertical_circle
                                                                                                </mat-icon>
                                                                                            </div>
                                                                                            <div class="del-icon"  [style.display]="allowToUpdate?'block':'none'" style="position:absolute; top:10px; right: 10px">
                                                                                                <mat-icon   (click)="deleteProductAttribute(i)" 
                                                                                                            matTooltip="{{t('docs.tip.delete')}}"    
                                                                                                            class="nav-icon">cancel
                                                                                                </mat-icon>
                                                                                            </div>
                                                                                        </div>
                                                                                        


                                                                                    <mat-card-content class="input-form" >
                                                                                        <div class="container-fluid">
                                                                                            <div class="row">
                                                                                                
                                                                                                <div class="col-xl-4 col-lg-12">
                                                                                                    <mat-form-field 
                                                                                                        class="slideWidth100 no-underline">
                                                                                                        <mat-slide-toggle 
                                                                                                            formControlName="visible" 
                                                                                                            matTooltip="{{t('docs.field.visible')}}">
                                                                                                            {{t('docs.field.visible')}}
                                                                                                        </mat-slide-toggle>
                                                                                                        <input matInput hidden/>
                                                                                                    </mat-form-field>

                                                                                                    <mat-form-field *ngIf="formBaseInformation.get('type').value=='variable'"
                                                                                                        class="slideWidth100 no-underline">
                                                                                                        <mat-slide-toggle 
                                                                                                            formControlName="variation" 
                                                                                                            (change)="fillDefaultProductAttributesArray()"
                                                                                                            matTooltip="{{t('docs.tip.variation')}}">
                                                                                                            {{t('docs.field.variation')}}
                                                                                                        </mat-slide-toggle>
                                                                                                        <input matInput hidden/>
                                                                                                    </mat-form-field>

                                                                                                    <mat-form-field style="display: none">
                                                                                                        <input matInput placeholder="id" formControlName="attribute_id"/>
                                                                                                    </mat-form-field>
                                                                                                </div>
                                                                                                <div class="col-xl-8  col-lg-12">
                                                                                                    <mat-form-field class="slideWidth100">
                                                                                                        
                                                                                                        <mat-label>Terms</mat-label>
                                                                                                        <mat-select formControlName="terms_ids" 
                                                                                                        (selectionChange)="fillDefaultProductAttributesArray()"
                                                                                                        multiple>
                                                                                                    
                                                                                                            <mat-select-trigger>
                                                                                                                <mat-chip-listbox>
                                                                                                                <mat-chip-option *ngFor="let term_id of attribute.value.terms_ids"
                                                                                                                    [removable]="false">
                                                                                                                    {{ getTermNameById(i, term_id) }}   
                                                                                                                </mat-chip-option>
                                                                                                                </mat-chip-listbox>
                                                                                                            </mat-select-trigger>
                                                                                                    
                                                                                                        <mat-option *ngFor="let term of getAttributeFieldValue(i, 'terms')" [value]="term.id">{{term.name}}</mat-option>
                                                                                                    
                                                                                                        </mat-select>
                                                                                                    </mat-form-field>
                                                                                                </div>
                                                                                            </div>
                                                                                        </div>
                                                                                                    
                                                                                            
                                                                                        <p *cdkDragPreview></p>


                                                                                    </mat-card-content>
                                                                                </mat-card>
                                                                            </div>
                                                                        </div>


                                                                    </div>


                                                                    <div class="col-12" *ngIf="prop_menu=='variations'"  style="width: 100% ;padding: 20px;">
                                                                        <div style="width:100%; padding:10px; text-align: left;">
                                                                            


                                                                            
                                                                        <mat-card  appearance="outlined"  style="background-color: #ff9898; width: 100%;margin-bottom: 5px;" *ngIf="!thereIsAttributesUsedForVariationsWithSelectedTerms">
                                                                            {{t('docs.card.add_attr_w_var')}}
                                                                        </mat-card>

                                                                        <mat-card  appearance="outlined"  style="background-color: #f7f7f7; width: 100%;margin-bottom: 5px;" *ngIf="thereIsAttributesUsedForVariationsWithSelectedTerms || formBaseInformation.get('productVariations').value.length>0">
                                                                            <mat-card-content>
                                                                                <div style = "width:100%">
                                                                                    <div style="position:relative; top:0px; left:0px; font-size: 20px; font-weight: 600;">
                                                                                        {{t('docs.card.action')}}
                                                                                    </div>
                                                                                    <mat-form-field style="width:35%; min-width:100px; margin-right: 10px;">
                                                                                        <mat-label>{{t('docs.field.select_action')}}</mat-label>
                                                                                        <mat-select>                          
                                                                                            <mat-option (click)="addVariation()" value="" [disabled]="!thereIsAttributesUsedForVariationsWithSelectedTerms">
                                                                                                {{t('docs.list.add_variation')}}
                                                                                            </mat-option> 
                                                                                            <mat-option (click)="onClickGenerateAllVariationsBtn()" value="" [disabled]="!thereIsAttributesUsedForVariationsWithSelectedTerms">
                                                                                                {{t('docs.list.gen_variation')}}
                                                                                            </mat-option> 
                                                                                            <mat-option (click)="deleteAllVariations()" value="" [disabled]="formBaseInformation.get('productVariations').value.length==0">
                                                                                                {{t('docs.list.del_variation')}}
                                                                                            </mat-option> 
                                                                                        </mat-select>
                                                                                    </mat-form-field>
                                                                                </div>
                                                                            </mat-card-content>
                                                                        </mat-card>










                                                                        <mat-card  appearance="outlined"  style="background-color: #f7f7f7; width: 100%;margin-bottom: 5px;" *ngIf="thereIsAttributesUsedForVariationsWithSelectedTerms">
                                                                            <mat-card-content>
                                                                                <div style = "width:100%">
                                                                                    <div style="position:relative; top:0px; left:0px; font-size: 20px; font-weight: 600;">
                                                                                        {{t('docs.card.def_value')}}
                                                                                    </div>
                                                                                    <mat-form-field  *ngFor="let attribute of formBaseInformation.get('defaultAttributes').controls;let i = index" 
                                                                                    [formGroup]="attribute"   class="col-xs-12 col-lg-6  col-xl-4">
                                                                                        <mat-label>{{attribute.value.name}}
                                                                                        </mat-label>
                                                                                        <mat-select  
                                                                                        formControlName="term_id"
                                                                                            >                
                                                                                            <mat-option [value]="0">- {{t('docs.list.any')}} -</mat-option>
                                                                                            <mat-option
                                                                                            *ngFor="let term of attribute.value.terms" 
                                                                                            [value]="term.id">
                                                                                                    {{term.name}} ({{term.id}})
                                                                                            </mat-option> 
                                                                                        </mat-select>
                                                                                    </mat-form-field>
                                                                                </div>
                                                                            </mat-card-content>
                                                                        </mat-card>






                                                                        <mat-card appearance="outlined" *ngIf="formBaseInformation.get('productVariations').value.length>0" style="background-color: #f7f7f7; width: 100%;margin-bottom: 5px;">
                                                                            <mat-card-content>
                                                                                <div style = "width:100%">
                                                                                    <div style="position:relative; top:0px; left:0px; font-size: 20px; font-weight: 600;margin-bottom: 10px;">
                                                                                        {{t('docs.card.variations')}}
                                                                                    </div>
                                                                                    <div cdkDropList (cdkDropListDropped)="dropVariation($event)">
                                                                                        <mat-card   appearance="outlined"   *ngFor="let variation of formBaseInformation.get('productVariations').controls;let i = index" 
                                                                                        [formGroup]="variation"
                                                                                                cdkDrag
                                                                                                    style="background-color: #f7f7f7; width: 100%; padding-bottom: 10px;">
                                                                                            <div style = "width:100%">
                                                                                                <div cdkDragHandle class="handler"  [style.display]="allowToUpdate?'block':'none'" style="position:absolute; top:3px; right: 32px">
                                                                                                    <mat-icon   matTooltip="{{t('docs.tip.move')}}" 
                                                                                                                class="nav-icon"
                                                                                                                *ngIf="formBaseInformation.get('productVariations').value.length>1">
                                                                                                                swap_vertical_circle
                                                                                                    </mat-icon>
                                                                                                </div>
                                                                                                <div class="del-icon"  [style.display]="allowToUpdate?'block':'none'" style="position:absolute; top:3px; right: 7px">
                                                                                                    <mat-icon   (click)="deleteVariation(i)" 
                                                                                                                matTooltip="{{t('docs.tip.delete')}}"    
                                                                                                                class="nav-icon">cancel
                                                                                                    </mat-icon>
                                                                                                </div>
                                                                                            </div>
                                                                                                
                                                                                            <mat-card-content class="input-form" style="padding:20px 16px 0 0;">
                                                                                                <div class="container-fluid">
                                                                                                    <div class="row">
                                                                                                        <div class="col-xs-12 col-sm-12 col-xl-8">
                                                                                                            <div class="container-fluid">
                                                                                                                <div class="row">
                                                                                                                    <div    *ngFor="let variationRow of getVariationsControlTablefield(i).controls; let m = index" 
                                                                                                                            class="col-xs-12 col-sm-12 col-xl-6">
                                                                                                                        <mat-form-field [formGroup]="variationRow" style="width:100%;">
                                                                                                                            <mat-label>
                                                                                                                                {{getAttributeVariationFieldValue(variationRow.value.attribute_id)}}
                                                                                                                            </mat-label>
                                                                                                                            <mat-select  
                                                                                                                            formControlName="term_id"
                                                                                                                                >          
                                                                                                                                <mat-option [value]="0">- {{t('docs.list.any')}} -</mat-option>
                                                                                                                                <mat-option
                                                                                                                                *ngFor="let term of variationRow.value.terms" 
                                                                                                                        
                                                                                                                                [value]="term.id">
                                                                                                                                        {{term.name}} ({{term.id}})
                                                                                                                                </mat-option> 
                                                                                                                            </mat-select>
                                                                                                                        </mat-form-field>
                                                                                                                    </div>
                                                                                                                </div>
                                                                                                            </div>
                                                                                                        </div>
                                                                                                        <div class="col-xs-12 col-sm-12 col-xl-4" style="padding-left: 0;">
                                                                                                            <div class="container-fluid" style="margin: 10px 10px 0;margin: 10px 10px 0;">
                                                                                                                <div class="row">
                                                                                                                    <div class="col-12" style="display:flex;min-height: 30px;">

                                                                                                                        <button 
                                                                                                                            *ngIf = "variation.value.variation_product_id == null" 
                                                                                                                            mat-raised-button 
                                                                                                                            (click)="openDialogProductCategoriesSelect('variation', i)"
                                                                                                                            color="primary"
                                                                                                                            style="margin:auto;">
                                                                                                                            {{t('docs.button.sel_prod')}}
                                                                                                                        </button>
                
                                                                                                                        <div *ngIf = "variation.value.variation_product_id != null" style="width:100%; position: relative;">
                                                                                                                            <div class="v-center" style="height: 30px;width: 100%;">
                                                                                                                                <a class="v-center" style="text-decoration: none; color:#585858" target="_blank" href="ui/productsdoc/{{variation.value.variation_product_id}}">{{variation.value.variation_product_name}}</a>
                                                                                                                                <!-- <span class="v-center"style="">{{variation.value.variation_product_name}}</span> -->
                                                                                                                                <span class="material-icons v-center" style="cursor:pointer;right: -23px" (click)="actionProductOfVariation(null, i, 'delete')">
                                                                                                                                    clear
                                                                                                                                </span>
                                                                                                                            </div>
                                                                                                                        </div>   
                                                                                                                    </div>
                                                                                                                </div>
                                                                                                            </div>
                                                                                                        </div>
                                                                                                    </div>
                                                                                                </div>
                                                                                                <p *cdkDragPreview></p>
                                                                                            </mat-card-content>
                                                                                        </mat-card>
                                                                                    </div>
                                                                                </div>
                                                                            </mat-card-content>
                                                                        </mat-card>



















                                                                        </div>
                                                                    </div>


                                                                    <div class="col-12 drawer-settings" *ngIf="prop_menu=='advanced'">
                                                                        <mat-form-field class="slideWidth100">
                                                                            <mat-label>{{t('docs.field.purch_note')}}</mat-label>
                                                                            <textarea  matInput
                                                                                    placeholder="{{t('docs.field.purch_note')}}"
                                                                                    maxlength="1000"
                                                                                    matTooltip="{{t('docs.tip.purch_note')}}" 
                                                                                    formControlName="purchase_note">
                                                                            </textarea>
                                                                            <mat-hint align="end" *ngIf="formBaseInformation.get('purchase_note').value.length>900">{{formBaseInformation.get('purchase_note').value.length}} / 1000</mat-hint>
                                                                        </mat-form-field>
                                                                        <mat-form-field class="slideWidth100">
                                                                            <mat-label>{{t('docs.field.menu_order')}}</mat-label>
                                                                            <input  matInput
                                                                                    placeholder="{{t('docs.field.menu_order')}}"
                                                                                    maxlength="8"
                                                                                    (keypress)="numberOnly($event)"
                                                                                    formControlName="menu_order"/>
                                                                            <mat-hint  align="start" *ngIf="formBaseInformation.get('menu_order').touched && formBaseInformation.get('menu_order').invalid">
                                                                                <i *ngIf="formBaseInformation.get('menu_order').errors.pattern" class="form-invalid">{{t('docs.error.price_format',{int:8,fract:0})}}</i>
                                                                            </mat-hint>
                                                                        </mat-form-field>
                                                                        <mat-form-field 
                                                                            class="slideWidth100">
                                                                            <mat-slide-toggle 
                                                                            formControlName="reviews_allowed"
                                                                            >{{t('docs.field.revws_allwd')}}</mat-slide-toggle>
                                                                            <input matInput hidden/>
                                                                        </mat-form-field>


                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </mat-drawer-content>                                                      
                                                    </mat-drawer-container>                                                           
                                                </div>
                                            </div>



                                            
                                        </mat-card-content>
                                    </mat-card>  


                                    
                                    <mat-card appearance="outlined" style="margin:10px;">
                                        <mat-card-header>
                                            <mat-card-title class="card-title">{{t('docs.card.description')}}</mat-card-title>
                                        </mat-card-header>
                                        <mat-card-content class="input-form">
                                            <div style="display:flex">
                                                <div>
                                                    <span class="sortheader" style="line-height: 25px;font-weight: 600;">{{t('docs.field.'+(isVariation?'optional_description':'description'))}}</span>
                                                </div>
                                                <div>
                                                    <mat-select formControlName="description_type" style="margin: 4px 0px 0px 20px;">
                                                        <option value="" selected></option>
                                                        <mat-option value="editor">{{t('docs.list.editor')}}</mat-option>
                                                        <mat-option value="custom">HTML</mat-option>
                                                    </mat-select>    
                                                </div>
                                            </div> 
                                            
                                            <mat-form-field *ngIf="formBaseInformation.get('description_type').value=='custom'" style="border: 1px solid #ccc;">
                                                <textarea  matInput
                                                    maxlength="100000"
                                                    formControlName="description_html"
                                                    [rows]="15"
                                                    #description_html>
                                                </textarea>
                                                <mat-hint align="end" *ngIf="description_html.value.length>90000">{{description_html.value.length}} / 100000</mat-hint>
                                            </mat-form-field>
                                            
                                            <quill-editor 
                                                *ngIf="formBaseInformation.get('description_type').value=='editor'"
                                                id="quill2"
                                                style="margin-bottom: 20px;"
                                                formControlName="description"
                                                [modules]="tools" 
                                                [format]="'html'" 
                                                [styles]="{height: '400px'}"
                                                placeholder= "Insert text here ..."
                                                maxnLength=100000
                                                ng-invalid 
                                                >
                                            </quill-editor>
                                            <!-- In variations there is no own short desctioption. The Descrioption and Short descrioption information are getting from parent product.
                                            Variation has only one own description - Optional description for variation. The value of this description getting from 
                                            the "Description" field of variation, that in Variation products renamed into "Optional description for variation". -->
                                            <div *ngIf="!isVariation" style="width:100%;">
                                                <div style="display:flex; margin-top: 20px;width:100%;">
                                                    <div>
                                                        <span class="sortheader" style="line-height: 25px;font-weight: 600;">{{t('docs.field.short_description')}}</span>
                                                    </div>
                                                    <div>
                                                        <mat-select formControlName="short_description_type" style="margin: 4px 0px 0px 20px;">
                                                            <option value="" selected></option>
                                                            <mat-option value="editor">{{t('docs.list.editor')}}</mat-option>
                                                            <mat-option value="custom">HTML</mat-option>
                                                        </mat-select>    
                                                    </div>
                                                </div>
                                                <mat-form-field  *ngIf="formBaseInformation.get('short_description_type').value=='custom'" style="border: 1px solid #ccc;width:100%;">
                                                    <textarea  matInput
                                                        maxlength="100000"
                                                        formControlName="short_description_html"
                                                        [rows]="10"
                                                        #short_description_html>
                                                    </textarea>
                                                    <mat-hint align="end" *ngIf="short_description_html.value.length>9000">{{short_description_html.value.length}} / 100000</mat-hint>
                                                </mat-form-field>
                                                <quill-editor 
                                                    *ngIf="formBaseInformation.get('short_description_type').value=='editor'"
                                                    id="quill1"
                                                    style="margin-bottom: 20px;width:100%;"
                                                    formControlName="short_description"
                                                    [modules]="tools" 
                                                    [format]="'html'" 
                                                    [styles]="{height: '200px'}"
                                                    placeholder= "Insert text here ..."
                                                    maxnLength=100000
                                                    ng-invalid 
                                                    >
                                                </quill-editor>
                                            </div>
                                        </mat-card-content>
                                    </mat-card>
                                </mat-tab>  
                                <mat-tab  *ngIf="visAfterCreatingBlocks"  label="{{t('docs.tab.about')}}">
                                    <div class="col-xl-5 col-lg-5 col-md-8 col-sm-12">
                                        <div class="container-fluid">
                                            <div class="row">
                                                <mat-card appearance="outlined" style="margin:10px 0 10px;width:100%;">
                                                    <form [formGroup]="formAboutDocument">
                                                        <mat-card-content class="input-form">
                                                                <mat-form-field [ngClass]="{invisible: +id==0}">
                                                                    <input  matInput
                                                                            placeholder="{{t('docs.field.company')}}"
                                                                            formControlName="company" [readonly]=true/>
                                                                </mat-form-field>
                                                                <mat-form-field [ngClass]="{invisible:  +id==0}">
                                                                    <input  matInput
                                                                            placeholder="{{t('docs.field.creator')}}"
                                                                            formControlName="creator" [readonly]=true/>
                                                                </mat-form-field>
                                                                <mat-form-field [ngClass]="{invisible:  +id==0}">
                                                                    <input  matInput
                                                                            placeholder="{{t('docs.field.created')}}"
                                                                            formControlName="date_time_created" [readonly]=true/>
                                                                </mat-form-field>
                                                                <mat-form-field [ngClass]="{invisible:  +id==0}">
                                                                    <input  matInput
                                                                            placeholder="{{t('docs.field.changer')}}"
                                                                            formControlName="changer" [readonly]=true/>
                                                                </mat-form-field>
                                                                <mat-form-field [ngClass]="{invisible:  +id==0}">
                                                                    <input  matInput
                                                                            placeholder="{{t('docs.field.changed')}}"
                                                                            formControlName="date_time_changed" [readonly]=true/>
                                                                </mat-form-field>
                                                        </mat-card-content>
                                                    </form>
                                                </mat-card>  
                                            </div>
                                        </div>
                                    </div>
                                </mat-tab>

                        </mat-tab-group>
                        <mat-tab-group *ngIf = "storeTranslationModeOn" style="margin-top: -14px;" (selectedTabChange)="quillTranslateRefresh()">
                            <mat-tab *ngFor="let translation of formBaseInformation.get('storeProductTranslations').controls; let i = index" [formGroup]="translation" [label]="translation.get('langCode').value">
                                <div class="container-fluid">        
                                    <div class="row">
                                        <div class="col-12">
                                            <mat-card appearance="outlined" style="margin: 15px 0">
                                                <mat-card-content class="input-form">
                                                    <mat-form-field style="width: 100%">
                                                        <input  matInput
                                                                placeholder="{{'docs.field.name' | transloco}}"
                                                                #name
                                                                maxlength="500"
                                                                formControlName="name"/>
                                                        <mat-hint align="end" *ngIf="name.value.length>450">{{name.value.length}} / 500</mat-hint>
                                                    </mat-form-field>
                                                    <mat-form-field style="width: 100%">
                                                        <input  matInput
                                                                placeholder="{{'docs.field.slug' | transloco}}"
                                                                #slug
                                                                maxlength="500"
                                                                formControlName="slug"/>
                                                        <mat-hint align="end" *ngIf="slug.value.length>400">{{slug.value.length}} / 500</mat-hint>
                                                    </mat-form-field>
                                                    <mat-card appearance="outlined" style="margin:10px;">
                                                        <mat-card-header>
                                                            <mat-card-title class="card-title">{{t('docs.card.description')}}</mat-card-title>
                                                        </mat-card-header>
                                                        <mat-card-content class="input-form">
                                                            <div style="display:flex; margin-top: 20px;">
                                                                <div>
                                                                    <span class="sortheader" style="line-height: 25px;font-weight: 600;">{{t('docs.field.'+(isVariation?'optional_description':'description'))}}</span>
                                                                </div>
                                                            </div> 
                                                            <mat-form-field *ngIf="formBaseInformation.get('description_type').value=='custom'" style="border: 1px solid #ccc;">
                                                                <textarea  matInput
                                                                    maxlength="100000"
                                                                    formControlName="descriptionHtml"
                                                                    [rows]="15"
                                                                    #descriptionHtml>
                                                                </textarea>
                                                                <mat-hint align="end" *ngIf="descriptionHtml.value.length>90000">{{descriptionHtml.value.length}} / 100000</mat-hint>
                                                            </mat-form-field>
                                                            
                                                            <quill-editor 
                                                                *ngIf="formBaseInformation.get('description_type').value=='editor'"
                                                                id="quill2"
                                                                style="margin-bottom: 20px;"
                                                                formControlName="description"
                                                                [modules]="tools" 
                                                                [format]="'html'" 
                                                                [styles]="{height: '400px'}"
                                                                placeholder= "Insert text here ..."
                                                                maxnLength=100000
                                                                ng-invalid 
                                                                >
                                                            </quill-editor>
                                                            <div *ngIf="!isVariation" style="width:100%;">
                                                                <div style="display:flex; margin-top: 20px;width:100%;">
                                                                    <div>
                                                                        <span class="sortheader" style="line-height: 25px;font-weight: 600;">{{t('docs.field.short_description')}}</span>
                                                                    </div>
                                                                </div>
                                                                <mat-form-field  *ngIf="formBaseInformation.get('short_description_type').value=='custom'" style="border: 1px solid #ccc;width:100%;">
                                                                    <textarea  matInput
                                                                        style="width:100%;"
                                                                        maxlength="100000"
                                                                        formControlName="shortDescriptionHtml"
                                                                        [rows]="10"
                                                                        #shortDescriptionHtml>
                                                                    </textarea>
                                                                    <mat-hint align="end" *ngIf="shortDescriptionHtml.value.length>90000">{{shortDescriptionHtml.value.length}} / 100000</mat-hint>
                                                                </mat-form-field>
                                                                <quill-editor 
                                                                    *ngIf="formBaseInformation.get('short_description_type').value=='editor'"
                                                                    id="quill1"
                                                                    style="margin-bottom: 20px;width:100%;"
                                                                    formControlName="shortDescription"
                                                                    [modules]="tools" 
                                                                    [format]="'html'" 
                                                                    [styles]="{height: '200px'}"
                                                                    placeholder= "Insert text here ..."
                                                                    maxnLength=100000
                                                                    ng-invalid 
                                                                    >
                                                                </quill-editor>
                                                            </div>
                                                        </mat-card-content>
                                                    </mat-card>
                                                </mat-card-content>
                                            </mat-card>
                                        </div>
                                    </div>
                                </div>
                            </mat-tab>
                        </mat-tab-group>
                    </form>
                </mat-card-content> 
            </mat-card>
        </div>
        <!-- <code><pre>{{formBaseInformation.value | json}}</pre></code> -->
        <!-- <code><pre>{{spravSysEdizmOfProductCurrent | json}}</pre></code> -->
    </mat-drawer-content>
</mat-drawer-container>